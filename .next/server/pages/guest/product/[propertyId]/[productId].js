"use strict";(()=>{var e={};e.id=260,e.ids=[260,888,660],e.modules={4638:(e,t,r)=>{r.r(t),r.d(t,{config:()=>P,default:()=>j,getServerSideProps:()=>N,getStaticPaths:()=>_,getStaticProps:()=>v,reportWebVitals:()=>S,routeModule:()=>F,unstable_getServerProps:()=>C,unstable_getServerSideProps:()=>I,unstable_getStaticParams:()=>k,unstable_getStaticPaths:()=>w,unstable_getStaticProps:()=>q});var a={};r.r(a),r.d(a,{default:()=>ProductDetail});var s=r(7093),l=r(5244),n=r(1323),i=r(9209),o=r.n(i),c=r(9597),d=r(997),u=r(6689),p=r(1163),x=r(1664),m=r.n(x),g=r(5675),h=r.n(g),b=r(9488),f=r(6999),y=r(4478);function ProductDetail(){let[e,t]=(0,u.useState)(null),[r,a]=(0,u.useState)(1),[s,l]=(0,u.useState)(!0),[n,i]=(0,u.useState)(null),{addToCart:o}=(0,f.j)(),c=(0,p.useRouter)(),{propertyId:x,productId:g,category:b}=c.query;(0,u.useEffect)(()=>{x&&g&&fetchProduct();async function fetchProduct(){try{l(!0);let{data:e,error:r}=await y.O.from("inventory").select(`
            id,
            apartment_id,
            quantity,
            price,
            product_id,
            products ( name, description, image_url, category )
          `).eq("apartment_id",x).eq("product_id",g).single();if(r)throw r;if(!e)throw Error("Product not found");t(e)}catch(e){console.error("Error fetching product:",e),i(e.message||"Failed to load product details")}finally{l(!1)}}},[x,g]);let handleQuantityChange=t=>{a(r=>{let a=r+t;return a<1?1:e&&a>e.quantity?e.quantity:a})};return s?d.jsx("div",{className:"text-center py-8",children:d.jsx("i",{className:"fas fa-spinner fa-spin text-2xl text-gray-500"})}):n?(0,d.jsxs)("div",{className:"bg-red-100 text-red-700 p-3 rounded mb-4",children:[n,d.jsx("div",{className:"mt-4",children:d.jsx(m(),{href:`/guest/menu/${x}`,children:d.jsx("span",{className:"text-blue-500 hover:underline cursor-pointer",children:"Back to Menu"})})})]}):e?(0,d.jsxs)("div",{children:[d.jsx("div",{className:"bg-white p-2 rounded-xl mb-4 inline-block",children:d.jsx(m(),{href:b?`/guest/menu/${x}?category=${encodeURIComponent(b)}`:`/guest/menu/${x}`,children:d.jsx("span",{className:"text-sm text-[#5e2bff] font-semibold underline cursor-pointer",children:"Back to Menu"})})}),(0,d.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[e.products.image_url?d.jsx("div",{className:"relative w-full h-64",children:d.jsx(h(),{src:e.products.image_url,alt:e.products.name,layout:"fill",objectFit:"cover",priority:!0})}):d.jsx("div",{className:"w-full h-64 bg-gray-200 flex items-center justify-center",children:d.jsx("span",{className:"text-gray-500",children:"No image available"})}),(0,d.jsxs)("div",{className:"p-4",children:[d.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-800 mb-2",children:e.products.name}),d.jsx("p",{className:"text-gray-600 mb-4",children:e.products.description||"No description available"}),(0,d.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,d.jsxs)("span",{className:"text-lg font-bold text-gray-800",children:["€",parseFloat(e.price).toFixed(2)]}),(0,d.jsxs)("span",{className:"text-sm text-gray-600",children:[e.quantity," in stock"]})]}),(0,d.jsxs)("div",{className:"flex flex-col items-center mt-6",children:[(0,d.jsxs)("div",{className:"flex items-center mb-4",children:[d.jsx("button",{onClick:()=>handleQuantityChange(-1),className:"bg-gray-200 text-gray-700 px-3 py-1 rounded-full text-xl font-bold","aria-label":"Decrease quantity",children:"−"}),d.jsx("input",{type:"number",value:r,onChange:e=>{let t=parseInt(e.target.value);isNaN(t)||a(t)},min:"1",max:e.quantity,className:"w-16 mx-2 border rounded px-2 py-1 text-center"}),d.jsx("button",{onClick:()=>handleQuantityChange(1),className:"bg-gray-200 text-gray-700 px-3 py-1 rounded-full text-xl font-bold","aria-label":"Increase quantity",children:"+"})]}),(0,d.jsxs)("button",{onClick:()=>{e&&(o({propertyId:e.apartment_id,productId:e.product_id,name:e.products.name,price:parseFloat(e.price),quantity:r}),b?c.push(`/guest/menu/${x}?category=${encodeURIComponent(b)}`):c.push(`/guest/menu/${x}`))},className:"bg-[#fad02f] text-black px-6 py-2 rounded-full text-base font-semibold hover:opacity-90 transition w-full sm:w-auto",children:["Add for €",(parseFloat(e.price)*r).toFixed(2)]})]})]})]}),e.products.category&&d.jsx("div",{className:"mt-4 inline-block bg-gray-100 px-3 py-1 rounded-full text-sm text-gray-700",children:e.products.category})]}):null}ProductDetail.getLayout=function(e){return d.jsx(b.Z,{title:"Product Details - Guestify",children:e})};let j=(0,n.l)(a,"default"),v=(0,n.l)(a,"getStaticProps"),_=(0,n.l)(a,"getStaticPaths"),N=(0,n.l)(a,"getServerSideProps"),P=(0,n.l)(a,"config"),S=(0,n.l)(a,"reportWebVitals"),q=(0,n.l)(a,"unstable_getStaticProps"),w=(0,n.l)(a,"unstable_getStaticPaths"),k=(0,n.l)(a,"unstable_getStaticParams"),C=(0,n.l)(a,"unstable_getServerProps"),I=(0,n.l)(a,"unstable_getServerSideProps"),F=new s.PagesRouteModule({definition:{kind:l.x.PAGES,page:"/guest/product/[propertyId]/[productId]",pathname:"/guest/product/[propertyId]/[productId]",bundlePath:"",filename:""},components:{App:c.default,Document:o()},userland:a})},2885:e=>{e.exports=require("@supabase/supabase-js")},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},968:e=>{e.exports=require("next/head")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},9796:e=>{e.exports=require("zlib")}};var t=require("../../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[761,163,209,450,664,201,675,597,488],()=>__webpack_exec__(4638));module.exports=r})();