"use strict";(()=>{var e={};e.id=882,e.ids=[882,888,660],e.modules={5706:(e,t,r)=>{r.r(t),r.d(t,{config:()=>N,default:()=>j,getServerSideProps:()=>y,getStaticPaths:()=>f,getStaticProps:()=>b,reportWebVitals:()=>S,routeModule:()=>C,unstable_getServerProps:()=>_,unstable_getServerSideProps:()=>w,unstable_getStaticParams:()=>k,unstable_getStaticPaths:()=>P,unstable_getStaticProps:()=>v});var s={};r.r(s),r.d(s,{default:()=>Cart});var a=r(7093),l=r(5244),i=r(1323),d=r(9209),n=r.n(d),c=r(9597),o=r(997),x=r(6689),u=r(1163),p=r(1664),h=r.n(p),m=r(9488),g=r(6999);function Cart(){let{cart:e,propertyId:t,updateCartItem:r,removeFromCart:s,getCartTotal:a}=(0,g.j)(),[l,i]=(0,x.useState)(!1),[d,n]=(0,x.useState)(null),c=(0,u.useRouter)(),handleCheckout=async()=>{if(0!==e.length){i(!0),n(null);try{let r=await fetch("/api/orders/checkout",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({propertyId:t,cart:e})}),s=await r.json();if(!r.ok)throw Error(s.error||"Checkout failed");c.push(`/guest/checkout?orderId=${s.orderId}`)}catch(e){console.error("Checkout error:",e),n(e.message||"Failed to process checkout")}finally{i(!1)}}},p=a(),m=.15*p;return(0,o.jsxs)("div",{children:[t&&o.jsx("div",{className:"bg-white p-2 rounded-xl mb-4 inline-block",children:o.jsx(h(),{href:`/guest/menu/${t}`,children:o.jsx("span",{className:"text-sm text-[#5e2bff] font-semibold underline cursor-pointer",children:"Back to Menu"})})}),o.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-800 mb-4",children:"Your Cart"}),d&&o.jsx("div",{className:"bg-red-100 text-red-700 p-3 rounded mb-4",children:d}),o.jsx("div",{className:"overflow-x-auto w-full",children:e&&e.length>0?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("table",{className:"table-auto w-full text-sm",children:[o.jsx("thead",{className:"bg-gray-100",children:(0,o.jsxs)("tr",{children:[o.jsx("th",{className:"px-2 py-2 text-left font-medium text-gray-700",children:"Product"}),o.jsx("th",{className:"px-2 py-2 text-left font-medium text-gray-700",children:"Price"}),o.jsx("th",{className:"px-2 py-2 text-left font-medium text-gray-700",children:"Quantity"}),o.jsx("th",{className:"px-2 py-2 w-10"}),o.jsx("th",{className:"px-2 py-2 text-left font-medium text-gray-700",children:"Subtotal"})]})}),o.jsx("tbody",{className:"divide-y divide-gray-200",children:e.map(e=>{let t=e.price*e.quantity;return(0,o.jsxs)("tr",{children:[o.jsx("td",{className:"px-2 py-2",children:e.name}),(0,o.jsxs)("td",{className:"px-2 py-2",children:["€",e.price.toFixed(2)]}),o.jsx("td",{className:"px-2 py-2",children:o.jsx("input",{type:"number",className:"w-16 border rounded px-2 py-1 text-sm",value:e.quantity,min:"1",onChange:t=>{let s=parseInt(t.target.value,10)||1;r(e.productId,e.propertyId,s)}})}),o.jsx("td",{className:"px-2 py-2 text-center w-10",children:o.jsx("button",{onClick:()=>s(e.productId,e.propertyId),className:"text-red-500 hover:text-red-700",title:"Remove",children:o.jsx("i",{className:"fas fa-trash"})})}),(0,o.jsxs)("td",{className:"px-2 py-2 text-right",children:["€",t.toFixed(2)]})]},`${e.propertyId}-${e.productId}`)})}),(0,o.jsxs)("tfoot",{className:"bg-white",children:[(0,o.jsxs)("tr",{children:[o.jsx("td",{colSpan:"4"}),(0,o.jsxs)("td",{className:"px-2 py-2 text-right text-gray-700",children:["Subtotal: €",p.toFixed(2)]})]}),(0,o.jsxs)("tr",{children:[o.jsx("td",{colSpan:"4"}),(0,o.jsxs)("td",{className:"px-2 py-2 text-right text-gray-700",children:["Service Fee: €",m.toFixed(2)]})]}),(0,o.jsxs)("tr",{children:[o.jsx("td",{colSpan:"4"}),(0,o.jsxs)("td",{className:"px-2 py-2 text-right font-bold text-gray-700",children:["Total: €",(p+m).toFixed(2)]})]})]})]}),o.jsx("div",{className:"mt-4 flex justify-end",children:o.jsx("button",{onClick:handleCheckout,disabled:l,className:"bg-[#fad02f] text-black px-3 py-1 rounded-full text-sm hover:bg-[#fad02f]/90 transition font-semibold",children:l?"Processing...":"Checkout"})})]}):(0,o.jsxs)("div",{children:[o.jsx("p",{className:"text-gray-500 mb-4",children:"Your cart is empty."}),t&&o.jsx("div",{className:"bg-white p-2 rounded-xl inline-block",children:o.jsx(h(),{href:`/guest/menu/${t}`,children:o.jsx("span",{className:"text-sm text-[#5e2bff] font-semibold underline cursor-pointer",children:"Back to Menu"})})})]})})]})}Cart.getLayout=function(e){return o.jsx(m.Z,{title:"Your Cart - Guestify",children:e})};let j=(0,i.l)(s,"default"),b=(0,i.l)(s,"getStaticProps"),f=(0,i.l)(s,"getStaticPaths"),y=(0,i.l)(s,"getServerSideProps"),N=(0,i.l)(s,"config"),S=(0,i.l)(s,"reportWebVitals"),v=(0,i.l)(s,"unstable_getStaticProps"),P=(0,i.l)(s,"unstable_getStaticPaths"),k=(0,i.l)(s,"unstable_getStaticParams"),_=(0,i.l)(s,"unstable_getServerProps"),w=(0,i.l)(s,"unstable_getServerSideProps"),C=new a.PagesRouteModule({definition:{kind:l.x.PAGES,page:"/guest/cart",pathname:"/guest/cart",bundlePath:"",filename:""},components:{App:c.default,Document:n()},userland:s})},2885:e=>{e.exports=require("@supabase/supabase-js")},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},968:e=>{e.exports=require("next/head")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},9796:e=>{e.exports=require("zlib")}};var t=require("../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[761,163,209,450,664,201,675,597,488],()=>__webpack_exec__(5706));module.exports=r})();