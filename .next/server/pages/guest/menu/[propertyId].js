"use strict";(()=>{var e={};e.id=333,e.ids=[333,888,660],e.modules={6795:(e,t,r)=>{r.r(t),r.d(t,{config:()=>S,default:()=>j,getServerSideProps:()=>_,getStaticPaths:()=>N,getStaticProps:()=>v,reportWebVitals:()=>w,routeModule:()=>C,unstable_getServerProps:()=>I,unstable_getServerSideProps:()=>A,unstable_getStaticParams:()=>k,unstable_getStaticPaths:()=>q,unstable_getStaticProps:()=>P});var s={};r.r(s),r.d(s,{default:()=>GuestMenu});var a=r(7093),l=r(5244),i=r(1323),n=r(9209),c=r.n(n),d=r(9597),o=r(997),u=r(6689),x=r(1163),m=r(1664),p=r.n(m),f=r(5675),g=r.n(f),h=r(9488),b=r(6999),y=r(4478);function GuestMenu(){let[e,t]=(0,u.useState)([]),[r,s]=(0,u.useState)(!0),[a,l]=(0,u.useState)(null),i=(0,x.useRouter)(),{propertyId:n,category:c}=i.query,{addToCart:d,setPropertyId:m}=(0,b.j)();(0,u.useEffect)(()=>{n&&(m(n),fetchInventory());async function fetchInventory(){try{s(!0);let{data:e,error:r}=await y.O.from("inventory").select(`
            id,
            apartment_id,
            quantity,
            price,
            product_id,
            products ( name, description, image_url, category )
          `).eq("apartment_id",n).gt("quantity",0);if(r)throw r;t(e||[])}catch(e){console.error("Error fetching inventory:",e),l("Failed to load products")}finally{s(!1)}}},[n,m]);let handleAddToCart=(e,t=1)=>{d({propertyId:e.apartment_id,productId:e.product_id,name:e.products.name,price:parseFloat(e.price),quantity:parseInt(t,10)})};if(!c)return(0,o.jsxs)("div",{className:"h-full flex flex-col justify-center",children:[o.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-800 mb-4 text-center",children:"Select a category"}),(0,o.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 flex-grow",children:[o.jsx(p(),{href:`/guest/menu/${n}?category=Food%20and%20Drinks`,children:(0,o.jsxs)("div",{className:"bg-white rounded-xl shadow flex flex-col items-center justify-center p-6 hover:shadow-lg transition cursor-pointer",style:{minHeight:"250px"},children:[o.jsx("i",{className:"fas fa-utensils fa-4x text-[#fad02f] mb-3"}),o.jsx("h3",{className:"text-lg font-bold text-[#000000] mb-1",children:"Food and Drinks"}),o.jsx("p",{className:"text-sm text-gray-600 text-center",children:"View all food and drinks."})]})}),o.jsx(p(),{href:`/guest/menu/${n}?category=Articles`,children:(0,o.jsxs)("div",{className:"bg-white rounded-xl shadow flex flex-col items-center justify-center p-6 hover:shadow-lg transition cursor-pointer",style:{minHeight:"250px"},children:[o.jsx("i",{className:"fas fa-box-open fa-4x text-[#fad02f] mb-3"}),o.jsx("h3",{className:"text-lg font-bold text-[#000000] mb-1",children:"Articles"}),o.jsx("p",{className:"text-sm text-gray-600 text-center",children:"View all articles."})]})})]})]});let f=e.filter(e=>e.products?.category===c);return r?o.jsx("div",{className:"text-center py-8",children:o.jsx("i",{className:"fas fa-spinner fa-spin text-2xl text-gray-500"})}):a?o.jsx("div",{className:"bg-red-100 text-red-700 p-3 rounded mb-4",children:a}):(0,o.jsxs)("div",{children:[(0,o.jsxs)("h2",{className:"text-xl sm:text-2xl font-bold text-gray-800 mb-4",children:["Products - ",c]}),o.jsx("div",{className:"grid grid-cols-2 gap-4",children:f.length>0?f.map(e=>(0,o.jsxs)("div",{className:"bg-white p-4 rounded-xl shadow-sm border flex flex-col",children:[o.jsx(p(),{href:`/guest/product/${e.apartment_id}/${e.product_id}?category=${encodeURIComponent(c)}`,children:o.jsx("div",{className:"cursor-pointer",children:e.products?.image_url?o.jsx("div",{className:"relative w-full h-40 mb-2",children:o.jsx(g(),{src:e.products.image_url,alt:e.products.name,layout:"fill",objectFit:"cover",className:"rounded"})}):o.jsx("div",{className:"w-full h-40 bg-gray-100 flex items-center justify-center rounded mb-2",children:o.jsx("span",{className:"text-gray-400 text-sm",children:"No Image"})})})}),o.jsx("h3",{className:"text-base sm:text-lg font-bold text-gray-800 mb-1",children:e.products?.name}),(0,o.jsxs)("p",{className:"text-sm text-gray-600 mb-1",children:["Availability: ",e.quantity]}),(0,o.jsxs)("p",{className:"text-sm text-gray-600 mb-2",children:["Price: â‚¬",parseFloat(e.price).toFixed(2)]}),o.jsx("div",{className:"mt-auto flex items-center space-x-2",children:(0,o.jsxs)("form",{className:"flex items-center space-x-2 w-full",children:[o.jsx("input",{type:"number",min:"1",max:e.quantity,defaultValue:"1",className:"w-16 border rounded px-2 py-1 text-sm",onChange:e=>{e.target.dataset.quantity=e.target.value}}),o.jsx("button",{type:"button",onClick:t=>{let r=parseInt(t.target.form[0].dataset.quantity||t.target.form[0].value,10);handleAddToCart(e,r)},className:"bg-[#fad02f] text-black px-3 py-1 rounded-full text-sm hover:bg-[#fad02f]/90 transition flex-grow font-semibold",children:"Add to Cart"})]})})]},e.id)):o.jsx("p",{className:"col-span-2 text-center text-gray-500",children:"No products available in this category."})}),o.jsx("div",{className:"mt-4",children:o.jsx(p(),{href:`/guest/menu/${n}`,children:o.jsx("span",{className:"text-sm text-[#5e2bff] font-semibold underline cursor-pointer",children:"Back to Menu"})})})]})}GuestMenu.getLayout=function(e){return o.jsx(h.Z,{title:"Menu - Guestify",children:e})};let j=(0,i.l)(s,"default"),v=(0,i.l)(s,"getStaticProps"),N=(0,i.l)(s,"getStaticPaths"),_=(0,i.l)(s,"getServerSideProps"),S=(0,i.l)(s,"config"),w=(0,i.l)(s,"reportWebVitals"),P=(0,i.l)(s,"unstable_getStaticProps"),q=(0,i.l)(s,"unstable_getStaticPaths"),k=(0,i.l)(s,"unstable_getStaticParams"),I=(0,i.l)(s,"unstable_getServerProps"),A=(0,i.l)(s,"unstable_getServerSideProps"),C=new a.PagesRouteModule({definition:{kind:l.x.PAGES,page:"/guest/menu/[propertyId]",pathname:"/guest/menu/[propertyId]",bundlePath:"",filename:""},components:{App:d.default,Document:c()},userland:s})},2885:e=>{e.exports=require("@supabase/supabase-js")},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},968:e=>{e.exports=require("next/head")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},9796:e=>{e.exports=require("zlib")}};var t=require("../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[761,163,209,450,664,201,675,597,488],()=>__webpack_exec__(6795));module.exports=r})();