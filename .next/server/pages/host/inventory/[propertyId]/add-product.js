(()=>{var e={};e.id=741,e.ids=[741,888,660],e.modules={320:(e,t,r)=>{"use strict";r.r(t),r.d(t,{config:()=>w,default:()=>b,getServerSideProps:()=>v,getStaticPaths:()=>j,getStaticProps:()=>y,reportWebVitals:()=>N,routeModule:()=>k,unstable_getServerProps:()=>q,unstable_getServerSideProps:()=>C,unstable_getStaticParams:()=>I,unstable_getStaticPaths:()=>P,unstable_getStaticProps:()=>S});var s={};r.r(s),r.d(s,{default:()=>g});var a=r(7093),i=r(5244),n=r(1323),l=r(2899),o=r.n(l),c=r(3414),d=r(997),u=r(6689),m=r(1163),p=r(1664),x=r.n(p),h=r(5621),f=r(8316);function g(){let[e,t]=(0,u.useState)({barcode:"",name:"",price:"",quantity:"1",description:"",category:"Food and Drinks",image_url:""}),[r,s]=(0,u.useState)(null),[a,i]=(0,u.useState)(""),[n,l]=(0,u.useState)(!1),[o,c]=(0,u.useState)(!1),[p,h]=(0,u.useState)(null),[g,b]=(0,u.useState)(!1),y=(0,m.useRouter)(),{propertyId:j}=y.query,v=e=>{let{name:r,value:a,type:n}=e.target;if("file"===n){let t=e.target.files[0];if(s(t),t){let e=URL.createObjectURL(t);return i(e),()=>URL.revokeObjectURL(e)}}else t(e=>({...e,[r]:a}))},w=async t=>{t.preventDefault(),l(!0),h(null);try{let t,s=e.image_url;if(r){let e=r.name.split(".").pop(),t=`${Math.random().toString(36).substring(2,15)}.${e}`,a=`product-images/${t}`,{error:i}=await f.O.storage.from("guestify").upload(a,r);if(i)throw i;let{data:n}=f.O.storage.from("guestify").getPublicUrl(a);s=n.publicUrl}let{data:a,error:i}=await f.O.from("products").select("id").eq("barcode",e.barcode).maybeSingle();if(i&&"PGRST116"!==i.code)throw i;if(a){let{data:r,error:i}=await f.O.from("products").update({name:e.name,description:e.description,category:e.category,image_url:s}).eq("id",a.id).select().single();if(i)throw i;t=r.id}else{let{data:r,error:a}=await f.O.from("products").insert([{barcode:e.barcode,name:e.name,description:e.description,category:e.category,image_url:s}]).select().single();if(a)throw a;t=r.id}let{data:n,error:l}=await f.O.from("inventory").select("id").eq("apartment_id",j).eq("product_id",t).maybeSingle();if(l&&"PGRST116"!==l.code)throw l;if(n){let{error:t}=await f.O.from("inventory").update({quantity:parseInt(e.quantity),price:parseFloat(e.price)}).eq("id",n.id);if(t)throw t}else{let{error:r}=await f.O.from("inventory").insert([{apartment_id:j,product_id:t,quantity:parseInt(e.quantity),price:parseFloat(e.price)}]);if(r)throw r}b(!0),setTimeout(()=>{y.push(`/host/inventory/${j}`)},1500)}catch(e){console.error("Error adding product:",e),h("Failed to add product"),l(!1)}};return(0,d.jsxs)("div",{className:"max-w-2xl mx-auto bg-white p-6 rounded-lg shadow-md",children:[(0,d.jsxs)("div",{className:"mb-4 flex justify-between items-center",children:[d.jsx("h2",{className:"text-xl font-bold",children:"Add Product"}),d.jsx(x(),{href:`/host/inventory/${j}`,children:d.jsx("span",{className:"text-blue-500 hover:underline cursor-pointer",children:"Back to Inventory"})})]}),p&&d.jsx("div",{className:"bg-red-100 text-red-700 p-3 rounded mb-4",children:p}),g&&d.jsx("div",{className:"bg-green-100 text-green-700 p-3 rounded mb-4",children:"Product added successfully! Redirecting..."}),(0,d.jsxs)("form",{onSubmit:w,className:"space-y-4",children:[(0,d.jsxs)("div",{className:"mb-4",children:[(0,d.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[d.jsx("label",{className:"block text-gray-700 mb-1 font-medium",children:"Barcode:"}),d.jsx("button",{type:"button",onClick:o?()=>{c(!1)}:()=>{c(!0)},className:"bg-blue-500 text-white px-3 py-1 rounded text-sm hover:bg-blue-600 transition",children:o?"Stop Scanning":"Scan Barcode"})]}),d.jsx("input",{type:"text",name:"barcode",value:e.barcode,onChange:v,className:"w-full border rounded px-3 py-2",placeholder:"Enter or scan barcode"})]}),o&&(0,d.jsxs)("div",{className:"mb-4 bg-black text-center p-4 rounded relative",children:[d.jsx("div",{className:"text-white mb-2",children:"Point camera at barcode"}),d.jsx("div",{className:"bg-white w-full h-40 flex items-center justify-center",children:d.jsx("span",{className:"text-gray-500",children:"Camera preview would appear here"})}),d.jsx("div",{className:"border-2 border-white absolute inset-0 m-8 pointer-events-none"})]}),(0,d.jsxs)("div",{children:[d.jsx("label",{className:"block text-gray-700 mb-1 font-medium",children:"Product Name:"}),d.jsx("input",{type:"text",name:"name",value:e.name,onChange:v,className:"w-full border rounded px-3 py-2",placeholder:"Product name",required:!0})]}),(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,d.jsxs)("div",{children:[d.jsx("label",{className:"block text-gray-700 mb-1 font-medium",children:"Price (EUR):"}),d.jsx("input",{type:"number",step:"0.01",name:"price",value:e.price,onChange:v,className:"w-full border rounded px-3 py-2",placeholder:"0.00",required:!0})]}),(0,d.jsxs)("div",{children:[d.jsx("label",{className:"block text-gray-700 mb-1 font-medium",children:"Quantity:"}),d.jsx("input",{type:"number",name:"quantity",value:e.quantity,onChange:v,className:"w-full border rounded px-3 py-2",placeholder:"1",min:"1",required:!0})]})]}),(0,d.jsxs)("div",{children:[d.jsx("label",{className:"block text-gray-700 mb-1 font-medium",children:"Description:"}),d.jsx("textarea",{name:"description",value:e.description,onChange:v,className:"w-full border rounded px-3 py-2 h-24",placeholder:"Product description"})]}),(0,d.jsxs)("div",{children:[d.jsx("label",{className:"block text-gray-700 mb-1 font-medium",children:"Category:"}),(0,d.jsxs)("div",{className:"flex space-x-4",children:[(0,d.jsxs)("label",{className:"inline-flex items-center",children:[d.jsx("input",{type:"radio",name:"category",value:"Food and Drinks",checked:"Food and Drinks"===e.category,onChange:v,className:"mr-2",required:!0}),d.jsx("span",{children:"Food and Drinks"})]}),(0,d.jsxs)("label",{className:"inline-flex items-center",children:[d.jsx("input",{type:"radio",name:"category",value:"Articles",checked:"Articles"===e.category,onChange:v,className:"mr-2",required:!0}),d.jsx("span",{children:"Articles"})]})]})]}),(0,d.jsxs)("div",{children:[d.jsx("label",{className:"block text-gray-700 mb-1 font-medium",children:"Product Image:"}),a&&d.jsx("div",{className:"mb-2",children:d.jsx("img",{src:a,alt:"Preview",className:"w-32 h-32 object-cover rounded border"})}),d.jsx("input",{type:"file",name:"image",onChange:v,accept:"image/*",className:"w-full border rounded px-3 py-2"})]}),(0,d.jsxs)("div",{className:"flex justify-between pt-4",children:[d.jsx(x(),{href:`/host/inventory/${j}`,children:d.jsx("span",{className:"px-4 py-2 bg-gray-300 text-gray-800 rounded hover:bg-gray-400 transition cursor-pointer",children:"Cancel"})}),d.jsx("button",{type:"submit",disabled:n,className:"px-4 py-2 bg-[#fad02f] text-black rounded hover:opacity-90 transition font-semibold",children:n?"Adding...":"Add Product"})]})]})]})}g.getLayout=function(e){return d.jsx(h.Z,{title:"Add Product - Guestify",children:e})};let b=(0,n.l)(s,"default"),y=(0,n.l)(s,"getStaticProps"),j=(0,n.l)(s,"getStaticPaths"),v=(0,n.l)(s,"getServerSideProps"),w=(0,n.l)(s,"config"),N=(0,n.l)(s,"reportWebVitals"),S=(0,n.l)(s,"unstable_getStaticProps"),P=(0,n.l)(s,"unstable_getStaticPaths"),I=(0,n.l)(s,"unstable_getStaticParams"),q=(0,n.l)(s,"unstable_getServerProps"),C=(0,n.l)(s,"unstable_getServerSideProps"),k=new a.PagesRouteModule({definition:{kind:i.x.PAGES,page:"/host/inventory/[propertyId]/add-product",pathname:"/host/inventory/[propertyId]/add-product",bundlePath:"",filename:""},components:{App:c.default,Document:o()},userland:s})},5621:(e,t,r)=>{"use strict";r.d(t,{Z:()=>u});var s=r(997),a=r(968),i=r.n(a),n=r(1664),l=r.n(n),o=r(5675),c=r.n(o);r(1163);var d=r(8473);function u({children:e,title:t="Guestify"}){let{user:r,signOut:a}=(0,d.a)();return(0,s.jsxs)("div",{className:"flex flex-col min-h-screen bg-gray-50 text-gray-800",children:[(0,s.jsxs)(i(),{children:[s.jsx("title",{children:t}),s.jsx("meta",{name:"description",content:"Guestify - Food service for Airbnb hosts"}),s.jsx("link",{rel:"icon",href:"/favicon.ico"})]}),s.jsx("header",{className:"bg-[#5e2bff] p-4 shadow-md rounded-b-xl",children:(0,s.jsxs)("div",{className:"max-w-6xl mx-auto flex justify-between items-center",children:[s.jsx("div",{className:"flex items-center",children:r?s.jsx(l(),{href:"/host/dashboard",children:s.jsx("span",{className:"cursor-pointer",children:s.jsx(c(),{src:"/images/guestify_logo.png",alt:"Guestify",width:40,height:40,className:"h-10 w-auto"})})}):s.jsx("span",{children:s.jsx(c(),{src:"/images/guestify_logo.png",alt:"Guestify",width:40,height:40,className:"h-10 w-auto"})})}),s.jsx("nav",{className:"flex items-center",children:r?(0,s.jsxs)(s.Fragment,{children:[s.jsx(l(),{href:"/host/dashboard",children:s.jsx("span",{className:"mx-1 sm:mx-2 text-white font-semibold hover:opacity-80 transition-colors text-sm sm:text-base cursor-pointer",children:"Dashboard"})}),s.jsx("button",{onClick:a,className:"mx-1 sm:mx-2 text-white hover:opacity-80 transition-colors text-sm sm:text-base bg-transparent border-none cursor-pointer",children:"Logout"}),s.jsx(l(),{href:"/host/profile",children:s.jsx("span",{className:"ml-2 cursor-pointer",children:s.jsx("div",{className:"h-8 w-8 rounded-full bg-white text-[#5e2bff] flex items-center justify-center",children:s.jsx("i",{className:"fas fa-smile"})})})})]}):(0,s.jsxs)(s.Fragment,{children:[s.jsx(l(),{href:"/auth/signin",children:s.jsx("span",{className:"mx-1 sm:mx-2 text-white hover:opacity-80 transition-colors text-sm sm:text-base cursor-pointer",children:"Login"})}),s.jsx(l(),{href:"/auth/signup",children:s.jsx("span",{className:"mx-1 sm:mx-2 text-white hover:opacity-80 transition-colors text-sm sm:text-base cursor-pointer",children:"Signup"})})]})})]})}),s.jsx("main",{className:"max-w-6xl mx-auto my-4 p-2 sm:p-4 rounded-xl flex-grow w-full",children:e}),s.jsx("footer",{className:"bg-[#5e2bff] p-4 rounded-t-xl",children:s.jsx("div",{className:"max-w-6xl mx-auto text-center text-white text-sm",children:(0,s.jsxs)("p",{children:["\xa9 ",new Date().getFullYear()," Guestify"]})})})]})}},8473:(e,t,r)=>{"use strict";r.d(t,{H:()=>o,a:()=>c});var s=r(997),a=r(6689),i=r(1163),n=r(8316);let l=(0,a.createContext)();function o({children:e}){let[t,r]=(0,a.useState)(null),[o,c]=(0,a.useState)(null),[d,u]=(0,a.useState)(!0),m=(0,i.useRouter)(),p=async(e,t)=>{try{let{data:r,error:s}=await n.O.auth.signInWithPassword({email:e,password:t});if(s)throw s;return{user:r.user,error:null}}catch(e){return{user:null,error:e}}},x=async(e,t,r)=>{try{let{data:s,error:a}=await n.O.auth.signUp({email:e,password:t,options:{data:r}});if(a)throw a;return s.user&&await n.O.from("profiles").insert([{id:s.user.id,...r}]),{user:s.user,error:null}}catch(e){return{user:null,error:e}}},h=async()=>{await n.O.auth.signOut(),m.push("/auth/signin")},f=async e=>{try{let{data:t,error:r}=await n.O.auth.resetPasswordForEmail(e,{redirectTo:`${window.location.origin}/auth/reset-password`});if(r)throw r;return{data:t,error:null}}catch(e){return{data:null,error:e}}},g=async e=>{try{let{data:t,error:r}=await n.O.auth.updateUser({password:e});if(r)throw r;return{user:t.user,error:null}}catch(e){return{user:null,error:e}}},b=async e=>{try{let{data:r,error:s}=await n.O.from("profiles").update(e).eq("id",t.id);if(s)throw s;return c({...o,...e}),{profile:r,error:null}}catch(e){return{profile:null,error:e}}};return s.jsx(l.Provider,{value:{user:t,profile:o,loading:d,signIn:p,signUp:x,signOut:h,resetPassword:f,updatePassword:g,updateProfile:b},children:e})}let c=()=>(0,a.useContext)(l)},5026:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n,j:()=>l});var s=r(997),a=r(6689);let i=(0,a.createContext)();function n({children:e}){let[t,r]=(0,a.useState)([]),[n,l]=(0,a.useState)(null);return s.jsx(i.Provider,{value:{cart:t,propertyId:n,setPropertyId:l,addToCart:e=>{let s=t.findIndex(t=>t.productId===e.productId&&t.propertyId===e.propertyId);if(s>=0){let a=[...t];a[s].quantity+=e.quantity,r(a)}else r([...t,e]);n||l(e.propertyId)},updateCartItem:(e,s,a)=>{r(t.map(t=>t.productId===e&&t.propertyId===s?{...t,quantity:a}:t))},removeFromCart:(e,s)=>{r(t.filter(t=>!(t.productId===e&&t.propertyId===s)))},clearCart:()=>{r([])},getCartTotal:()=>t.reduce((e,t)=>e+t.price*t.quantity,0),getCartCount:()=>t.reduce((e,t)=>e+t.quantity,0)},children:e})}let l=()=>(0,a.useContext)(i)},8316:(e,t,r)=>{"use strict";r.d(t,{O:()=>n});let s=require("@supabase/supabase-js"),a=process.env.NEXT_PUBLIC_SUPABASE_URL||"https://ndiqnzxplopcbcxzondp.supabase.co",i=process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5kaXFuenhwbG9wY2JjeHpvbmRwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzk1NDkxODQsImV4cCI6MjA1NTEyNTE4NH0.jCnn7TFfGV1EpBHhO1ITa8PMytD7UJfADpuzrzZOgpw";i||console.warn("Missing Supabase key");let n=(0,s.createClient)(a,i)},3414:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});var s=r(997),a=r(968),i=r.n(a),n=r(8473),l=r(5026);r(9605);let o=function({Component:e,pageProps:t}){let r=e.getLayout||(e=>e);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(i(),{children:[s.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),s.jsx("link",{href:"https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap",rel:"stylesheet"}),s.jsx("link",{rel:"stylesheet",href:"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"})]}),s.jsx(n.H,{children:s.jsx(l.Z,{children:r(s.jsx(e,{...t}))})})]})}},9605:()=>{},2785:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},968:e=>{"use strict";e.exports=require("next/head")},6689:e=>{"use strict";e.exports=require("react")},6405:e=>{"use strict";e.exports=require("react-dom")},997:e=>{"use strict";e.exports=require("react/jsx-runtime")},2048:e=>{"use strict";e.exports=require("fs")},5315:e=>{"use strict";e.exports=require("path")},6162:e=>{"use strict";e.exports=require("stream")},1568:e=>{"use strict";e.exports=require("zlib")}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[429,163,301,637],()=>r(320));module.exports=s})();