"use strict";(()=>{var e={};e.id=202,e.ids=[202,888,660],e.modules={2599:(e,s,a)=>{a.r(s),a.d(s,{config:()=>g,default:()=>h,getServerSideProps:()=>w,getStaticPaths:()=>b,getStaticProps:()=>f,reportWebVitals:()=>y,routeModule:()=>_,unstable_getServerProps:()=>N,unstable_getServerSideProps:()=>S,unstable_getStaticParams:()=>v,unstable_getStaticPaths:()=>j,unstable_getStaticProps:()=>P});var r={};a.r(r),a.d(r,{default:()=>Profile});var t=a(7093),l=a(5244),d=a(1323),n=a(9209),o=a.n(n),i=a(9597),u=a(997),c=a(6689),p=a(1163),m=a(9430),x=a(7016);function Profile(){let{user:e,profile:s,updateProfile:a,updatePassword:r}=(0,x.a)(),[t,l]=(0,c.useState)({name:"",phone:""}),[d,n]=(0,c.useState)({old_password:"",new_password:"",confirm_password:""}),[o,i]=(0,c.useState)(!1),[m,h]=(0,c.useState)(!1),[f,b]=(0,c.useState)(null),[w,g]=(0,c.useState)(null),[y,P]=(0,c.useState)(null),[j,v]=(0,c.useState)(null);(0,p.useRouter)(),(0,c.useEffect)(()=>{s&&l({name:s.name||"",phone:s.phone||""})},[s]);let handleProfileChange=e=>{let{name:s,value:a}=e.target;l({...t,[s]:a})},handlePasswordChange=e=>{let{name:s,value:a}=e.target;n({...d,[s]:a})},handleProfileSubmit=async e=>{e.preventDefault(),i(!0),P(null),b(null);try{let{error:e}=await a(t);if(e)throw e;b("Profile updated successfully.")}catch(e){console.error("Error updating profile:",e),P(e.message||"Failed to update profile")}finally{i(!1)}},handlePasswordSubmit=async s=>{if(s.preventDefault(),h(!0),v(null),g(null),d.new_password!==d.confirm_password){v("New passwords do not match"),h(!1);return}try{let{data:s,error:a}=await signIn(e.email,d.old_password);if(a)throw Error("Current password is incorrect");let{error:t}=await r(d.new_password);if(t)throw t;g("Password updated successfully."),n({old_password:"",new_password:"",confirm_password:""})}catch(e){console.error("Error updating password:",e),v(e.message||"Failed to update password")}finally{h(!1)}};return e&&s?(0,u.jsxs)("div",{className:"max-w-3xl mx-auto bg-white p-6 rounded-md shadow mt-10",children:[f&&u.jsx("div",{className:"mb-6 p-3 bg-green-100 text-green-800 rounded",children:f}),y&&u.jsx("div",{className:"mb-6 p-3 bg-red-100 text-red-800 rounded",children:y}),u.jsx("h2",{className:"text-2xl font-bold mb-6",children:"User Profile"}),(0,u.jsxs)("div",{className:"mb-10",children:[u.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Personal Information"}),(0,u.jsxs)("form",{onSubmit:handleProfileSubmit,className:"space-y-4",children:[(0,u.jsxs)("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),u.jsx("input",{type:"email",value:e.email,className:"w-full border rounded px-3 py-2 bg-gray-100",readOnly:!0})]}),(0,u.jsxs)("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Country"}),u.jsx("input",{type:"text",value:s.country||"",className:"w-full border rounded px-3 py-2 bg-gray-100",readOnly:!0})]}),(0,u.jsxs)("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),u.jsx("input",{type:"text",name:"name",value:t.name,onChange:handleProfileChange,className:"w-full border rounded px-3 py-2",required:!0})]}),(0,u.jsxs)("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Phone Number"}),u.jsx("input",{type:"text",name:"phone",value:t.phone,onChange:handleProfileChange,className:"w-full border rounded px-3 py-2"})]}),u.jsx("div",{className:"flex justify-end",children:u.jsx("button",{type:"submit",className:"px-4 py-2 bg-[#fad02f] text-black rounded hover:opacity-90 transition font-semibold",disabled:o,children:o?"Saving...":"Save"})})]})]}),(0,u.jsxs)("div",{children:[u.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Change Password"}),w&&u.jsx("div",{className:"mb-4 p-3 bg-green-100 text-green-800 rounded",children:w}),j&&u.jsx("div",{className:"mb-4 p-3 bg-red-100 text-red-800 rounded",children:j}),(0,u.jsxs)("form",{onSubmit:handlePasswordSubmit,className:"space-y-4",children:[(0,u.jsxs)("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Old Password"}),u.jsx("input",{type:"password",name:"old_password",value:d.old_password,onChange:handlePasswordChange,className:"w-full border rounded px-3 py-2",placeholder:"Old Password",required:!0})]}),(0,u.jsxs)("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"New Password"}),u.jsx("input",{type:"password",name:"new_password",value:d.new_password,onChange:handlePasswordChange,className:"w-full border rounded px-3 py-2",placeholder:"New Password",required:!0})]}),(0,u.jsxs)("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Confirm New Password"}),u.jsx("input",{type:"password",name:"confirm_password",value:d.confirm_password,onChange:handlePasswordChange,className:"w-full border rounded px-3 py-2",placeholder:"Confirm New Password",required:!0})]}),u.jsx("div",{className:"flex justify-end",children:u.jsx("button",{type:"submit",className:"px-4 py-2 bg-[#fad02f] text-black rounded hover:opacity-90 transition font-semibold",disabled:m,children:m?"Updating...":"Change Password"})})]})]})]}):u.jsx("div",{className:"text-center py-8",children:u.jsx("i",{className:"fas fa-spinner fa-spin text-2xl text-gray-500"})})}Profile.getLayout=function(e){return u.jsx(m.Z,{title:"Profile - Guestify",children:e})};let h=(0,d.l)(r,"default"),f=(0,d.l)(r,"getStaticProps"),b=(0,d.l)(r,"getStaticPaths"),w=(0,d.l)(r,"getServerSideProps"),g=(0,d.l)(r,"config"),y=(0,d.l)(r,"reportWebVitals"),P=(0,d.l)(r,"unstable_getStaticProps"),j=(0,d.l)(r,"unstable_getStaticPaths"),v=(0,d.l)(r,"unstable_getStaticParams"),N=(0,d.l)(r,"unstable_getServerProps"),S=(0,d.l)(r,"unstable_getServerSideProps"),_=new t.PagesRouteModule({definition:{kind:l.x.PAGES,page:"/host/profile",pathname:"/host/profile",bundlePath:"",filename:""},components:{App:i.default,Document:o()},userland:r})},2885:e=>{e.exports=require("@supabase/supabase-js")},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},968:e=>{e.exports=require("next/head")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},9796:e=>{e.exports=require("zlib")}};var s=require("../../webpack-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),a=s.X(0,[761,163,209,450,664,201,675,597,430],()=>__webpack_exec__(2599));module.exports=a})();