"use strict";(()=>{var e={};e.id=641,e.ids=[641,888,660],e.modules={6390:(e,t,r)=>{r.r(t),r.d(t,{config:()=>j,default:()=>f,getServerSideProps:()=>y,getStaticPaths:()=>b,getStaticProps:()=>g,reportWebVitals:()=>S,routeModule:()=>w,unstable_getServerProps:()=>P,unstable_getServerSideProps:()=>q,unstable_getStaticParams:()=>N,unstable_getStaticPaths:()=>v,unstable_getStaticProps:()=>_});var s={};r.r(s),r.d(s,{default:()=>Orders});var a=r(7093),i=r(5244),d=r(1323),l=r(9209),o=r.n(l),n=r(9597),c=r(997),p=r(6689),x=r(1163),u=r(9430),m=r(5240),h=r(4478);function Orders(){let[e,t]=(0,p.useState)([]),[r,s]=(0,p.useState)(""),[a,i]=(0,p.useState)(!0),[d,l]=(0,p.useState)(null),o=(0,x.useRouter)(),{propertyId:n}=o.query;return(0,p.useEffect)(()=>{n&&fetchData();async function fetchData(){try{i(!0);let{data:e,error:r}=await h.O.from("apartments").select("name").eq("id",n).single();if(r)throw r;s(e.name);let{data:a,error:d}=await h.O.from("orders").select("*").eq("apartment_id",n).order("order_date",{ascending:!1});if(d)throw d;t(a||[])}catch(e){console.error("Error fetching orders:",e),l("Failed to load orders")}finally{i(!1)}}},[n]),(0,c.jsxs)("div",{children:[c.jsx(m.Z,{propertyId:n,activeTab:"orders",propertyName:r}),c.jsx("h2",{className:"text-base sm:text-lg font-semibold text-gray-800 mb-4",children:"Orders"}),a?c.jsx("div",{className:"text-center py-8",children:c.jsx("i",{className:"fas fa-spinner fa-spin text-2xl text-gray-500"})}):d?c.jsx("div",{className:"bg-red-100 text-red-700 p-3 rounded mb-4",children:d}):c.jsx("div",{className:"bg-white shadow rounded-lg overflow-x-auto text-sm sm:text-base p-2",children:e&&e.length>0?(0,c.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-violet-100",children:(0,c.jsxs)("tr",{children:[c.jsx("th",{className:"px-4 py-2 text-left font-medium text-[#5e2bff]",children:"Order Date"}),c.jsx("th",{className:"px-4 py-2 text-left font-medium text-[#5e2bff]",children:"Order ID"}),c.jsx("th",{className:"px-4 py-2 text-left font-medium text-[#5e2bff]",children:"Total Price"})]})}),c.jsx("tbody",{className:"divide-y divide-gray-200",children:e.map(e=>{let t=new Date(e.order_date).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return(0,c.jsxs)("tr",{children:[c.jsx("td",{className:"px-4 py-2",children:t}),(0,c.jsxs)("td",{className:"px-4 py-2",children:["#",e.id]}),(0,c.jsxs)("td",{className:"px-4 py-2",children:["EUR ",Number(e.total_price).toFixed(2)]})]},e.id)})}),c.jsx("tfoot",{className:"bg-white",children:(0,c.jsxs)("tr",{children:[c.jsx("td",{colSpan:"2",className:"px-4 py-2 text-right font-bold text-gray-700",children:"Total Revenue:"}),(0,c.jsxs)("td",{className:"px-4 py-2 font-bold text-gray-700",children:["EUR ",e.reduce((e,t)=>e+parseFloat(t.total_price||0),0).toFixed(2)]})]})})]}):c.jsx("p",{className:"text-gray-500 p-4",children:"No orders yet."})})]})}Orders.getLayout=function(e){return c.jsx(u.Z,{title:"Orders - Guestify",children:e})};let f=(0,d.l)(s,"default"),g=(0,d.l)(s,"getStaticProps"),b=(0,d.l)(s,"getStaticPaths"),y=(0,d.l)(s,"getServerSideProps"),j=(0,d.l)(s,"config"),S=(0,d.l)(s,"reportWebVitals"),_=(0,d.l)(s,"unstable_getStaticProps"),v=(0,d.l)(s,"unstable_getStaticPaths"),N=(0,d.l)(s,"unstable_getStaticParams"),P=(0,d.l)(s,"unstable_getServerProps"),q=(0,d.l)(s,"unstable_getServerSideProps"),w=new a.PagesRouteModule({definition:{kind:i.x.PAGES,page:"/host/orders/[propertyId]",pathname:"/host/orders/[propertyId]",bundlePath:"",filename:""},components:{App:n.default,Document:o()},userland:s})},2885:e=>{e.exports=require("@supabase/supabase-js")},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},968:e=>{e.exports=require("next/head")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},9796:e=>{e.exports=require("zlib")}};var t=require("../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[761,163,209,450,664,201,675,597,430,240],()=>__webpack_exec__(6390));module.exports=r})();