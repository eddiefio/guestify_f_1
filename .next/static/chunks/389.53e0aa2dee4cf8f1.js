"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[389],{4389:function(e,r,t){t.r(r),t.d(r,{default:function(){return l}});var n=t(5893),c=t(7294),s=t(2277);function l(e){let{onDetected:r,isScanning:t,onError:l}=e,[a,i]=(0,c.useState)(null),o=(0,c.useRef)(null),u=(0,c.useRef)(null),d=(0,c.useRef)(!0),f=(0,c.useRef)(!1);return(0,c.useEffect)(()=>(d.current=!0,()=>{d.current=!1}),[]),(0,c.useEffect)(()=>{if(!t||f.current)return;console.log("Initializing scanner..."),f.current=!0;let e={fps:5,qrbox:250},n=null,c=()=>{n&&(console.log("Stopping scanner..."),n.stop().catch(e=>console.warn("Error stopping scanner:",e)),n=null),o.current=null},a=()=>{if(!u.current)return!1;for(;u.current.firstChild;)u.current.removeChild(u.current.firstChild);let e=document.createElement("div");return e.id="html5-qrcode-element",u.current.appendChild(e),!0};return(async()=>{try{if(!a()){console.error("Container not ready");return}n=new s.t2("html5-qrcode-element"),o.current=n,await n.start({facingMode:"environment"},e,e=>{console.log("Barcode detected:",e),r&&d.current&&n.stop().then(()=>{o.current=null,n=null,r(e)}).catch(t=>{console.warn("Error stopping scanner after detection:",t),d.current&&r(e)})},()=>{}),d.current&&i(null)}catch(e){console.error("Error initializing scanner:",e),d.current&&(i("Camera error: ".concat(e.message||"Cannot access camera")),l&&l(e))}})(),()=>{c(),t||(f.current=!1)}},[t,r,l]),(0,n.jsxs)("div",{className:"w-full",children:[a&&(0,n.jsx)("div",{className:"bg-red-100 text-red-700 p-3 rounded mb-2 text-sm",children:a}),(0,n.jsxs)("div",{ref:u,className:"w-full bg-black relative rounded overflow-hidden",style:{minHeight:"300px"},children:[t&&!a&&(0,n.jsx)("div",{className:"absolute inset-0 flex items-center justify-center text-white pointer-events-none",children:(0,n.jsx)("div",{className:"z-10 bg-black bg-opacity-50 p-2 rounded",children:(0,n.jsx)("p",{children:"Scanning..."})})}),!t&&(0,n.jsx)("div",{className:"absolute inset-0 flex items-center justify-center text-white",children:(0,n.jsx)("p",{children:"Press Scan to start camera"})})]}),(0,n.jsx)("p",{className:"text-xs text-gray-500 mt-2 text-center",children:t?"Point the camera at a barcode":"Press the Scan button to activate the camera"})]})}}}]);