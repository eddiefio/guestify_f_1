(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[741],{9451:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/host/inventory/[propertyId]/add-product",function(){return r(6275)}])},9430:function(e,t,r){"use strict";r.d(t,{Z:function(){return Layout}});var a=r(5893),s=r(9008),n=r.n(s),i=r(1664),c=r.n(i),l=r(5675),o=r.n(l);r(1163);var d=r(7016);function Layout(e){let{children:t,title:r="Guestify"}=e,{user:s,signOut:i}=(0,d.a)();return(0,a.jsxs)("div",{className:"flex flex-col min-h-screen bg-gray-50 text-gray-800",children:[(0,a.jsxs)(n(),{children:[(0,a.jsx)("title",{children:r}),(0,a.jsx)("meta",{name:"description",content:"Guestify - Food service for Airbnb hosts"}),(0,a.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,a.jsx)("header",{className:"bg-[#5e2bff] p-4 shadow-md rounded-b-xl",children:(0,a.jsxs)("div",{className:"max-w-6xl mx-auto flex justify-between items-center",children:[(0,a.jsx)("div",{className:"flex items-center",children:s?(0,a.jsx)(c(),{href:"/host/dashboard",children:(0,a.jsx)("span",{className:"cursor-pointer",children:(0,a.jsx)(o(),{src:"/images/guestify_logo.png",alt:"Guestify",width:40,height:40,className:"h-10 w-auto"})})}):(0,a.jsx)("span",{children:(0,a.jsx)(o(),{src:"/images/guestify_logo.png",alt:"Guestify",width:40,height:40,className:"h-10 w-auto"})})}),(0,a.jsx)("nav",{className:"flex items-center",children:s?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c(),{href:"/host/dashboard",children:(0,a.jsx)("span",{className:"mx-1 sm:mx-2 text-white font-semibold hover:opacity-80 transition-colors text-sm sm:text-base cursor-pointer",children:"Dashboard"})}),(0,a.jsx)("button",{onClick:i,className:"mx-1 sm:mx-2 text-white hover:opacity-80 transition-colors text-sm sm:text-base bg-transparent border-none cursor-pointer",children:"Logout"}),(0,a.jsx)(c(),{href:"/host/profile",children:(0,a.jsx)("span",{className:"ml-2 cursor-pointer",children:(0,a.jsx)("div",{className:"h-8 w-8 rounded-full bg-white text-[#5e2bff] flex items-center justify-center",children:(0,a.jsx)("i",{className:"fas fa-smile"})})})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c(),{href:"/auth/signin",children:(0,a.jsx)("span",{className:"mx-1 sm:mx-2 text-white hover:opacity-80 transition-colors text-sm sm:text-base cursor-pointer",children:"Login"})}),(0,a.jsx)(c(),{href:"/auth/signup",children:(0,a.jsx)("span",{className:"mx-1 sm:mx-2 text-white hover:opacity-80 transition-colors text-sm sm:text-base cursor-pointer",children:"Signup"})})]})})]})}),(0,a.jsx)("main",{className:"max-w-6xl mx-auto my-4 p-2 sm:p-4 rounded-xl flex-grow w-full",children:t}),(0,a.jsx)("footer",{className:"bg-[#5e2bff] p-4 rounded-t-xl",children:(0,a.jsx)("div",{className:"max-w-6xl mx-auto text-center text-white text-sm",children:(0,a.jsxs)("p",{children:["\xa9 ",new Date().getFullYear()," Guestify"]})})})]})}},6275:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return AddProduct}});var a=r(5893),s=r(7294),n=r(1163),i=r(1664),c=r.n(i),l=r(9430),o=r(824);function AddProduct(){let[e,t]=(0,s.useState)({barcode:"",name:"",price:"",quantity:"1",description:"",category:"Food and Drinks",image_url:""}),[r,i]=(0,s.useState)(null),[l,d]=(0,s.useState)(""),[m,u]=(0,s.useState)(!1),[h,x]=(0,s.useState)(!1),[p,f]=(0,s.useState)(null),[b,g]=(0,s.useState)(!1),y=(0,n.useRouter)(),{propertyId:j}=y.query;(0,s.useEffect)(()=>{y.query.barcode&&fetchProductByBarcode(y.query.barcode)},[y.query]);let fetchProductByBarcode=async r=>{try{u(!0);let{data:a,error:s}=await o.O.from("products").select("*").eq("barcode",r).single();if(s&&"PGRST116"!==s.code)throw s;a?(t({...e,barcode:a.barcode||"",name:a.name||"",description:a.description||"",category:a.category||"Food and Drinks",image_url:a.image_url||""}),a.image_url&&d(a.image_url)):t({...e,barcode:r})}catch(e){console.error("Error fetching product by barcode:",e),f("Failed to fetch product information")}finally{u(!1)}},handleChange=e=>{let{name:r,value:a,type:s}=e.target;if("file"===s){let t=e.target.files[0];if(i(t),t){let e=URL.createObjectURL(t);return d(e),()=>URL.revokeObjectURL(e)}}else t(e=>({...e,[r]:a}))},handleSubmit=async t=>{t.preventDefault(),u(!0),f(null);try{let t,a=e.image_url;if(r){let e=r.name.split(".").pop(),t="".concat(Math.random().toString(36).substring(2,15),".").concat(e),s="product-images/".concat(t),{error:n}=await o.O.storage.from("guestify").upload(s,r);if(n)throw n;let{data:i}=o.O.storage.from("guestify").getPublicUrl(s);a=i.publicUrl}let{data:s,error:n}=await o.O.from("products").select("id").eq("barcode",e.barcode).maybeSingle();if(n&&"PGRST116"!==n.code)throw n;if(s){let{data:r,error:n}=await o.O.from("products").update({name:e.name,description:e.description,category:e.category,image_url:a}).eq("id",s.id).select().single();if(n)throw n;t=r.id}else{let{data:r,error:s}=await o.O.from("products").insert([{barcode:e.barcode,name:e.name,description:e.description,category:e.category,image_url:a}]).select().single();if(s)throw s;t=r.id}let{data:i,error:c}=await o.O.from("inventory").select("id").eq("apartment_id",j).eq("product_id",t).maybeSingle();if(c&&"PGRST116"!==c.code)throw c;if(i){let{error:t}=await o.O.from("inventory").update({quantity:parseInt(e.quantity),price:parseFloat(e.price)}).eq("id",i.id);if(t)throw t}else{let{error:r}=await o.O.from("inventory").insert([{apartment_id:j,product_id:t,quantity:parseInt(e.quantity),price:parseFloat(e.price)}]);if(r)throw r}g(!0),setTimeout(()=>{y.push("/host/inventory/".concat(j))},1500)}catch(e){console.error("Error adding product:",e),f("Failed to add product"),u(!1)}};return(0,a.jsxs)("div",{className:"max-w-2xl mx-auto bg-white p-6 rounded-lg shadow-md",children:[(0,a.jsxs)("div",{className:"mb-4 flex justify-between items-center",children:[(0,a.jsx)("h2",{className:"text-xl font-bold",children:"Add Product"}),(0,a.jsx)(c(),{href:"/host/inventory/".concat(j),children:(0,a.jsx)("span",{className:"text-blue-500 hover:underline cursor-pointer",children:"Back to Inventory"})})]}),p&&(0,a.jsx)("div",{className:"bg-red-100 text-red-700 p-3 rounded mb-4",children:p}),b&&(0,a.jsx)("div",{className:"bg-green-100 text-green-700 p-3 rounded mb-4",children:"Product added successfully! Redirecting..."}),(0,a.jsxs)("form",{onSubmit:handleSubmit,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,a.jsx)("label",{className:"block text-gray-700 mb-1 font-medium",children:"Barcode:"}),(0,a.jsx)("button",{type:"button",onClick:h?()=>{x(!1)}:()=>{x(!0)},className:"bg-blue-500 text-white px-3 py-1 rounded text-sm hover:bg-blue-600 transition",children:h?"Stop Scanning":"Scan Barcode"})]}),(0,a.jsx)("input",{type:"text",name:"barcode",value:e.barcode,onChange:handleChange,className:"w-full border rounded px-3 py-2",placeholder:"Enter or scan barcode"})]}),h&&(0,a.jsxs)("div",{className:"mb-4 bg-black text-center p-4 rounded relative",children:[(0,a.jsx)("div",{className:"text-white mb-2",children:"Point camera at barcode"}),(0,a.jsx)("div",{className:"bg-white w-full h-40 flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-gray-500",children:"Camera preview would appear here"})}),(0,a.jsx)("div",{className:"border-2 border-white absolute inset-0 m-8 pointer-events-none"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-gray-700 mb-1 font-medium",children:"Product Name:"}),(0,a.jsx)("input",{type:"text",name:"name",value:e.name,onChange:handleChange,className:"w-full border rounded px-3 py-2",placeholder:"Product name",required:!0})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-gray-700 mb-1 font-medium",children:"Price (EUR):"}),(0,a.jsx)("input",{type:"number",step:"0.01",name:"price",value:e.price,onChange:handleChange,className:"w-full border rounded px-3 py-2",placeholder:"0.00",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-gray-700 mb-1 font-medium",children:"Quantity:"}),(0,a.jsx)("input",{type:"number",name:"quantity",value:e.quantity,onChange:handleChange,className:"w-full border rounded px-3 py-2",placeholder:"1",min:"1",required:!0})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-gray-700 mb-1 font-medium",children:"Description:"}),(0,a.jsx)("textarea",{name:"description",value:e.description,onChange:handleChange,className:"w-full border rounded px-3 py-2 h-24",placeholder:"Product description"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-gray-700 mb-1 font-medium",children:"Category:"}),(0,a.jsxs)("div",{className:"flex space-x-4",children:[(0,a.jsxs)("label",{className:"inline-flex items-center",children:[(0,a.jsx)("input",{type:"radio",name:"category",value:"Food and Drinks",checked:"Food and Drinks"===e.category,onChange:handleChange,className:"mr-2",required:!0}),(0,a.jsx)("span",{children:"Food and Drinks"})]}),(0,a.jsxs)("label",{className:"inline-flex items-center",children:[(0,a.jsx)("input",{type:"radio",name:"category",value:"Articles",checked:"Articles"===e.category,onChange:handleChange,className:"mr-2",required:!0}),(0,a.jsx)("span",{children:"Articles"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-gray-700 mb-1 font-medium",children:"Product Image:"}),l&&(0,a.jsx)("div",{className:"mb-2",children:(0,a.jsx)("img",{src:l,alt:"Preview",className:"w-32 h-32 object-cover rounded border"})}),(0,a.jsx)("input",{type:"file",name:"image",onChange:handleChange,accept:"image/*",className:"w-full border rounded px-3 py-2"})]}),(0,a.jsxs)("div",{className:"flex justify-between pt-4",children:[(0,a.jsx)(c(),{href:"/host/inventory/".concat(j),children:(0,a.jsx)("span",{className:"px-4 py-2 bg-gray-300 text-gray-800 rounded hover:bg-gray-400 transition cursor-pointer",children:"Cancel"})}),(0,a.jsx)("button",{type:"submit",disabled:m,className:"px-4 py-2 bg-[#fad02f] text-black rounded hover:opacity-90 transition font-semibold",children:m?"Adding...":"Add Product"})]})]})]})}AddProduct.getLayout=function(e){return(0,a.jsx)(l.Z,{title:"Add Product - Guestify",children:e})}}},function(e){e.O(0,[664,675,774,888,179],function(){return e(e.s=9451)}),_N_E=e.O()}]);