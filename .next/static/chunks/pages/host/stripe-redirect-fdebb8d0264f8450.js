(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[416],{7124:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/host/stripe-redirect",function(){return s(7281)}])},430:function(e,t,s){"use strict";s.d(t,{Z:function(){return x}});var r=s(5893),i=s(9008),n=s.n(i),o=s(1664),c=s.n(o),a=s(5675),l=s.n(a);s(1163);var d=s(5482);function x(e){let{children:t,title:s="Guestify"}=e,{user:i,signOut:o}=(0,d.a)();return(0,r.jsxs)("div",{className:"flex flex-col min-h-screen bg-gray-50 text-gray-800",children:[(0,r.jsxs)(n(),{children:[(0,r.jsx)("title",{children:s}),(0,r.jsx)("meta",{name:"description",content:"Guestify - Food service for Airbnb hosts"}),(0,r.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,r.jsx)("header",{className:"bg-[#5e2bff] py-1 px-4 shadow-md rounded-b-xl",children:(0,r.jsxs)("div",{className:"max-w-6xl mx-auto flex justify-between items-center",children:[(0,r.jsx)("div",{className:"flex items-center",children:i?(0,r.jsx)(c(),{href:"/host/dashboard",children:(0,r.jsx)("span",{className:"cursor-pointer",children:(0,r.jsx)(l(),{src:"/images/guestify_logo.png",alt:"Guestify",width:160,height:100,quality:100,priority:!0,className:"w-40 h-24",style:{objectFit:"contain"}})})}):(0,r.jsx)("span",{children:(0,r.jsx)(l(),{src:"/images/guestify_logo.png",alt:"Guestify",width:160,height:100,quality:100,priority:!0,className:"w-40 h-24",style:{objectFit:"contain"}})})}),(0,r.jsx)("nav",{className:"flex items-center",children:i?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c(),{href:"/host/dashboard",children:(0,r.jsx)("span",{className:"mx-1 sm:mx-2 text-white font-semibold hover:opacity-80 transition-colors text-sm sm:text-base cursor-pointer",children:"Dashboard"})}),(0,r.jsx)("button",{onClick:o,className:"mx-1 sm:mx-2 text-white hover:opacity-80 transition-colors text-sm sm:text-base bg-transparent border-none cursor-pointer",children:"Logout"}),(0,r.jsx)(c(),{href:"/host/profile",children:(0,r.jsx)("span",{className:"ml-2 cursor-pointer flex items-center",children:(0,r.jsx)("div",{className:"h-8 w-8 rounded-full bg-white text-[#5e2bff] flex items-center justify-center",children:(0,r.jsx)("i",{className:"fas fa-smile"})})})})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c(),{href:"/auth/signin",children:(0,r.jsx)("span",{className:"mx-1 sm:mx-2 text-white hover:opacity-80 transition-colors text-sm sm:text-base cursor-pointer",children:"Login"})}),(0,r.jsx)(c(),{href:"/auth/signup",children:(0,r.jsx)("span",{className:"mx-1 sm:mx-2 text-white hover:opacity-80 transition-colors text-sm sm:text-base cursor-pointer",children:"Signup"})})]})})]})}),(0,r.jsx)("main",{className:"max-w-6xl mx-auto my-4 p-2 sm:p-4 rounded-xl flex-grow w-full",children:t}),(0,r.jsx)("footer",{className:"bg-[#5e2bff] p-4 rounded-t-xl",children:(0,r.jsx)("div",{className:"max-w-6xl mx-auto text-center text-white text-sm",children:(0,r.jsxs)("p",{children:["\xa9 ",new Date().getFullYear()," Guestify"]})})})]})}},7281:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return l}});var r=s(5893),i=s(7294),n=s(1163),o=s(430),c=s(5482),a=s(5240);function l(){let[e,t]=(0,i.useState)("loading"),[s,o]=(0,i.useState)("Processing your Stripe connection..."),l=(0,n.useRouter)(),{user:d}=(0,c.a)();return(0,i.useEffect)(()=>{d&&l.isReady&&(async()=>{try{console.log("Processing Stripe redirect with user:",d.id);let{account_id:e,success:s,error:r}=l.query;if(r)throw Error("Error during Stripe onboarding process");if(!e)throw Error("No Stripe account ID provided in redirect");console.log("Received Stripe account ID:",e);let{data:i,error:n}=await a.OQ.from("profiles").update({stripe_account_id:e}).eq("id",d.id).select().single();if(n)throw console.error("Error updating profile:",n),n;console.log("Successfully updated profile with Stripe account ID"),t("success"),o("Your Stripe account has been successfully connected!"),setTimeout(()=>{let e=localStorage.getItem("property_id_for_qr");e?(localStorage.removeItem("property_id_for_qr"),l.push("/host/printqr/".concat(e))):l.push("/host/dashboard")},2e3)}catch(e){console.error("Error handling Stripe redirect:",e),t("error"),o("Error: ".concat(e.message||"Failed to connect Stripe account"))}})()},[d,l]),(0,r.jsxs)("div",{className:"max-w-md mx-auto bg-white p-6 rounded-lg shadow-md mt-10",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold mb-4 text-center",children:"loading"===e?"Processing Stripe Connection":"success"===e?"Stripe Connected!":"Connection Error"}),(0,r.jsxs)("div",{className:"mb-4 text-center",children:["loading"===e&&(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}),"success"===e&&(0,r.jsx)("div",{className:"text-green-500 text-5xl mb-4",children:(0,r.jsx)("i",{className:"fas fa-check-circle"})}),"error"===e&&(0,r.jsx)("div",{className:"text-red-500 text-5xl mb-4",children:(0,r.jsx)("i",{className:"fas fa-exclamation-circle"})}),(0,r.jsx)("p",{className:"mt-4 ".concat("loading"===e?"text-gray-600":"success"===e?"text-green-700":"text-red-700"),children:s})]}),"error"===e&&(0,r.jsx)("div",{className:"flex justify-center mt-4",children:(0,r.jsx)("button",{onClick:()=>l.push("/host/connect-stripe"),className:"bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition",children:"Try Again"})})]})}l.getLayout=function(e){return(0,r.jsx)(o.Z,{title:"Stripe Connection - Guestify",children:e})}}},function(e){e.O(0,[61,888,774,179],function(){return e(e.s=7124)}),_N_E=e.O()}]);