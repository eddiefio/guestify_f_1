(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[962],{3847:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/host/printqr/[propertyId]",function(){return s(5739)}])},3013:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var r=s(5893),i=s(1664),a=s.n(i);function n(e){let{propertyId:t,activeTab:s,propertyName:i}=e;return(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("div",{className:"mb-2",children:(0,r.jsx)(a(),{href:"/host/dashboard",children:(0,r.jsxs)("span",{className:"text-[#5e2bff] hover:underline flex items-center cursor-pointer",children:[(0,r.jsx)("i",{className:"fas fa-arrow-left mr-1"})," Back to Dashboard"]})})}),(0,r.jsxs)("h2",{className:"text-lg sm:text-2xl font-bold text-[#5e2bff] mb-4",children:["Property: ",i||""]}),(0,r.jsx)("div",{className:"flex flex-wrap justify-center items-center gap-2 mb-4",children:[{id:"analytics",label:"Analytics",href:"/host/analytics/".concat(t)},{id:"orders",label:"Orders",href:"/host/orders/".concat(t)},{id:"inventory",label:"Inventory",href:"/host/inventory/".concat(t)},{id:"printqr",label:"Print QR",href:"/host/printqr/".concat(t)}].map(e=>(0,r.jsx)(a(),{href:e.href,children:(0,r.jsx)("span",{className:"px-3 py-1 rounded text-sm hover:bg-gray-300 transition cursor-pointer ".concat(s===e.id?"bg-[#fad02f] text-black font-bold hover:opacity-90":"bg-gray-200"),children:e.label})},e.id))})]})}},430:function(e,t,s){"use strict";s.d(t,{Z:function(){return m}});var r=s(5893),i=s(9008),a=s.n(i),n=s(1664),l=s.n(n),o=s(5675),c=s.n(o);s(1163);var d=s(5482);function m(e){let{children:t,title:s="Guestify"}=e,{user:i,signOut:n}=(0,d.a)();return(0,r.jsxs)("div",{className:"flex flex-col min-h-screen bg-gray-50 text-gray-800",children:[(0,r.jsxs)(a(),{children:[(0,r.jsx)("title",{children:s}),(0,r.jsx)("meta",{name:"description",content:"Guestify - Food service for Airbnb hosts"}),(0,r.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,r.jsx)("header",{className:"bg-[#5e2bff] p-4 shadow-md rounded-b-xl",children:(0,r.jsxs)("div",{className:"max-w-6xl mx-auto flex justify-between items-center",children:[(0,r.jsx)("div",{className:"flex items-center",children:i?(0,r.jsx)(l(),{href:"/host/dashboard",children:(0,r.jsx)("span",{className:"cursor-pointer",children:(0,r.jsx)(c(),{src:"/images/guestify_logo.png",alt:"Guestify",width:40,height:40,className:"h-10 w-auto"})})}):(0,r.jsx)("span",{children:(0,r.jsx)(c(),{src:"/images/guestify_logo.png",alt:"Guestify",width:40,height:40,className:"h-10 w-auto"})})}),(0,r.jsx)("nav",{className:"flex items-center",children:i?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l(),{href:"/host/dashboard",children:(0,r.jsx)("span",{className:"mx-1 sm:mx-2 text-white font-semibold hover:opacity-80 transition-colors text-sm sm:text-base cursor-pointer",children:"Dashboard"})}),(0,r.jsx)("button",{onClick:n,className:"mx-1 sm:mx-2 text-white hover:opacity-80 transition-colors text-sm sm:text-base bg-transparent border-none cursor-pointer",children:"Logout"}),(0,r.jsx)(l(),{href:"/host/profile",children:(0,r.jsx)("span",{className:"ml-2 cursor-pointer",children:(0,r.jsx)("div",{className:"h-8 w-8 rounded-full bg-white text-[#5e2bff] flex items-center justify-center",children:(0,r.jsx)("i",{className:"fas fa-smile"})})})})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l(),{href:"/auth/signin",children:(0,r.jsx)("span",{className:"mx-1 sm:mx-2 text-white hover:opacity-80 transition-colors text-sm sm:text-base cursor-pointer",children:"Login"})}),(0,r.jsx)(l(),{href:"/auth/signup",children:(0,r.jsx)("span",{className:"mx-1 sm:mx-2 text-white hover:opacity-80 transition-colors text-sm sm:text-base cursor-pointer",children:"Signup"})})]})})]})}),(0,r.jsx)("main",{className:"max-w-6xl mx-auto my-4 p-2 sm:p-4 rounded-xl flex-grow w-full",children:t}),(0,r.jsx)("footer",{className:"bg-[#5e2bff] p-4 rounded-t-xl",children:(0,r.jsx)("div",{className:"max-w-6xl mx-auto text-center text-white text-sm",children:(0,r.jsxs)("p",{children:["\xa9 ",new Date().getFullYear()," Guestify"]})})})]})}},5739:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return h}});var r=s(5893),i=s(7294),a=s(1163),n=s(5675),l=s.n(n);s(1664);var o=s(430),c=s(3013),d=s(5240),m=s(2592),x=s(5482);function h(){let[e,t]=(0,i.useState)(""),[s,n]=(0,i.useState)(""),[o,h]=(0,i.useState)(""),[f,u]=(0,i.useState)(!0),[p,b]=(0,i.useState)(null),[g,y]=(0,i.useState)("idle"),[j,w]=(0,i.useState)(""),N=(0,i.useRef)(null),v=(0,a.useRouter)(),{propertyId:_}=v.query,{user:k,profile:P}=(0,x.a)();(0,i.useEffect)(()=>{if(_&&k){if(!(null==P?void 0:P.stripe_account_id)){v.push("/host/connect-stripe");return}e()}async function e(){try{u(!0);let{data:e,error:s}=await d.O.from("apartments").select("name").eq("id",_).single();if(s)throw s;t(e.name);let r=window.location.origin,i="".concat(r,"/guest/menu/").concat(_);h(i);let a=await m.toDataURL(i,{width:400,margin:1,color:{dark:"#5e2bff",light:"#ffffff"}});n(a)}catch(e){console.error("Error generating QR code:",e),b("Failed to generate QR code")}finally{u(!1)}}},[_,k,P,v]);let R=async()=>{try{y("preparing");let e=await fetch("/api/printqr-pdf?propertyId=".concat(_),{method:"GET"});if(!e.ok)throw Error("Failed to generate PDF");let t=await e.blob(),s=URL.createObjectURL(t);w(s),y("ready"),window.open(s,"_blank")}catch(e){console.error("Error creating PDF:",e),y("error")}};return(0,r.jsxs)("div",{children:[(0,r.jsx)(c.Z,{propertyId:_,activeTab:"printqr",propertyName:e}),f?(0,r.jsx)("div",{className:"flex justify-center items-center py-12",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-purple-500"})}):p?(0,r.jsx)("div",{className:"bg-red-100 text-red-700 p-4 rounded-lg mb-6",children:p}):(0,r.jsxs)("div",{className:"max-w-md mx-auto text-center bg-white p-6 rounded-lg shadow-md",children:[(0,r.jsx)("h3",{className:"text-xl font-semibold mb-6",children:"Menu QR Code"}),(0,r.jsx)("p",{className:"mb-6 text-gray-600",children:"Place this QR code in your rental property so guests can easily access your menu."}),(0,r.jsx)("div",{className:"mb-6 border p-4 rounded-lg bg-gray-50 mx-auto",style:{maxWidth:"280px"},ref:N,children:s&&(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-[#5e2bff] font-bold text-lg mb-2",children:"Guestify Menu"}),(0,r.jsx)("div",{className:"mb-4 mx-auto",style:{width:"200px",height:"200px",position:"relative"},children:(0,r.jsx)(l(),{src:s,alt:"QR Code",layout:"fill",objectFit:"contain"})}),(0,r.jsx)("div",{className:"text-sm text-gray-500 mt-2",children:e})]})}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row justify-center gap-4 mb-6",children:[(0,r.jsxs)("button",{onClick:()=>{if(N.current){let t=window.open("","","height=500,width=500");t.document.write("<html><head><title>Print QR Code</title>"),t.document.write("</head><body>"),t.document.write('<div style="text-align:center; padding:20px;">'),t.document.write('<h1 style="font-family:Arial,sans-serif;color:#5e2bff;">Guestify Menu</h1>'),t.document.write('<h2 style="font-family:Arial,sans-serif;color:#333;">'+e+"</h2>"),t.document.write('<div style="margin:30px 0;">'),t.document.write('<img src="'+s+'" style="width:300px;height:300px;" />'),t.document.write("</div>"),t.document.write('<p style="font-family:Arial,sans-serif;color:#666;">Scan this QR code to access the menu</p>'),t.document.write('<p style="font-family:Arial,sans-serif;color:#999;font-size:12px;">'+o+"</p>"),t.document.write("</div>"),t.document.write("</body></html>"),t.document.close(),t.focus(),setTimeout(()=>{t.print()},250)}},className:"bg-white border border-[#5e2bff] text-[#5e2bff] px-4 py-2 rounded-full hover:bg-purple-50 transition-colors flex items-center justify-center",children:[(0,r.jsx)("i",{className:"fas fa-print mr-2"}),"Print Directly"]}),(0,r.jsx)("button",{onClick:R,disabled:"preparing"===g,className:"bg-[#fad02f] text-black px-4 py-2 rounded-full hover:opacity-90 transition font-semibold flex items-center justify-center",children:"preparing"===g?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("i",{className:"fas fa-spinner fa-spin mr-2"}),"Preparing PDF..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("i",{className:"fas fa-file-pdf mr-2"}),"Download PDF"]})})]}),"ready"===g&&j&&(0,r.jsxs)("div",{className:"mt-4 p-3 bg-green-50 rounded-lg",children:[(0,r.jsx)("p",{className:"text-sm text-green-700 mb-2",children:"PDF generated successfully!"}),(0,r.jsx)("a",{href:j,download:"guestify-qrcode.pdf",className:"text-[#5e2bff] hover:underline text-sm",children:"Click here to download if it didn't open automatically"})]}),"error"===g&&(0,r.jsx)("div",{className:"mt-4 p-3 bg-red-50 rounded-lg",children:(0,r.jsx)("p",{className:"text-sm text-red-700",children:"There was an error generating the PDF. Please try again."})}),(0,r.jsxs)("div",{className:"mt-6",children:[(0,r.jsx)("p",{className:"text-sm text-gray-500 mb-1",children:"Or share this URL with your guests:"}),(0,r.jsxs)("div",{className:"flex items-center justify-center",children:[(0,r.jsx)("input",{type:"text",value:o,readOnly:!0,className:"w-full text-sm text-gray-700 border rounded-l px-3 py-2 bg-gray-50"}),(0,r.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(o),alert("URL copied to clipboard!")},className:"bg-gray-200 px-3 py-2 rounded-r hover:bg-gray-300 transition-colors",title:"Copy to clipboard",children:(0,r.jsx)("i",{className:"fas fa-copy"})})]})]})]})]})}h.getLayout=function(e){return(0,r.jsx)(o.Z,{title:"Print QR Code - Guestify",children:e})}}},function(e){e.O(0,[61,592,888,774,179],function(){return e(e.s=3847)}),_N_E=e.O()}]);