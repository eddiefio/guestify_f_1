(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[962],{3847:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/host/printqr/[propertyId]",function(){return s(5739)}])},3013:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var r=s(5893),a=s(1664),i=s.n(a);function n(e){let{propertyId:t,activeTab:s,propertyName:a}=e;return(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("div",{className:"mb-2",children:(0,r.jsx)(i(),{href:"/host/dashboard",children:(0,r.jsxs)("span",{className:"text-[#5e2bff] hover:underline flex items-center cursor-pointer",children:[(0,r.jsx)("i",{className:"fas fa-arrow-left mr-1"})," Back to Dashboard"]})})}),(0,r.jsxs)("h2",{className:"text-lg sm:text-2xl font-bold text-[#5e2bff] mb-4",children:["Property: ",a||""]}),(0,r.jsx)("div",{className:"flex flex-wrap justify-center items-center gap-2 mb-4",children:[{id:"analytics",label:"Analytics",href:"/host/analytics/".concat(t)},{id:"orders",label:"Orders",href:"/host/orders/".concat(t)},{id:"inventory",label:"Inventory",href:"/host/inventory/".concat(t)},{id:"printqr",label:"Print QR",href:"/host/printqr/".concat(t)}].map(e=>(0,r.jsx)(i(),{href:e.href,children:(0,r.jsx)("span",{className:"px-3 py-1 rounded text-sm hover:bg-gray-300 transition cursor-pointer ".concat(s===e.id?"bg-[#fad02f] text-black font-bold hover:opacity-90":"bg-gray-200"),children:e.label})},e.id))})]})}},430:function(e,t,s){"use strict";s.d(t,{Z:function(){return x}});var r=s(5893),a=s(9008),i=s.n(a),n=s(1664),l=s.n(n),c=s(5675),o=s.n(c);s(1163);var d=s(5482);function x(e){let{children:t,title:s="Guestify"}=e,{user:a,signOut:n}=(0,d.a)();return(0,r.jsxs)("div",{className:"flex flex-col min-h-screen bg-gray-50 text-gray-800",children:[(0,r.jsxs)(i(),{children:[(0,r.jsx)("title",{children:s}),(0,r.jsx)("meta",{name:"description",content:"Guestify - Food service for Airbnb hosts"}),(0,r.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,r.jsx)("header",{className:"bg-[#5e2bff] py-1 px-4 shadow-md rounded-b-xl",children:(0,r.jsxs)("div",{className:"max-w-6xl mx-auto flex justify-between items-center",children:[(0,r.jsx)("div",{className:"flex items-center",children:a?(0,r.jsx)(l(),{href:"/host/dashboard",children:(0,r.jsx)("span",{className:"cursor-pointer",children:(0,r.jsx)(o(),{src:"/images/guestify_logo.png",alt:"Guestify",width:160,height:100,quality:100,priority:!0,className:"w-40 h-24",style:{objectFit:"contain"}})})}):(0,r.jsx)("span",{children:(0,r.jsx)(o(),{src:"/images/guestify_logo.png",alt:"Guestify",width:160,height:100,quality:100,priority:!0,className:"w-40 h-24",style:{objectFit:"contain"}})})}),(0,r.jsx)("nav",{className:"flex items-center",children:a?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l(),{href:"/host/dashboard",children:(0,r.jsx)("span",{className:"mx-1 sm:mx-2 text-white font-semibold hover:opacity-80 transition-colors text-sm sm:text-base cursor-pointer",children:"Dashboard"})}),(0,r.jsx)("button",{onClick:n,className:"mx-1 sm:mx-2 text-white hover:opacity-80 transition-colors text-sm sm:text-base bg-transparent border-none cursor-pointer",children:"Logout"}),(0,r.jsx)(l(),{href:"/host/profile",children:(0,r.jsx)("span",{className:"ml-2 cursor-pointer flex items-center",children:(0,r.jsx)("div",{className:"h-8 w-8 rounded-full bg-white text-[#5e2bff] flex items-center justify-center",children:(0,r.jsx)("i",{className:"fas fa-smile"})})})})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l(),{href:"/auth/signin",children:(0,r.jsx)("span",{className:"mx-1 sm:mx-2 text-white hover:opacity-80 transition-colors text-sm sm:text-base cursor-pointer",children:"Login"})}),(0,r.jsx)(l(),{href:"/auth/signup",children:(0,r.jsx)("span",{className:"mx-1 sm:mx-2 text-white hover:opacity-80 transition-colors text-sm sm:text-base cursor-pointer",children:"Signup"})})]})})]})}),(0,r.jsx)("main",{className:"max-w-6xl mx-auto my-4 p-2 sm:p-4 rounded-xl flex-grow w-full",children:t}),(0,r.jsx)("footer",{className:"bg-[#5e2bff] p-4 rounded-t-xl",children:(0,r.jsx)("div",{className:"max-w-6xl mx-auto text-center text-white text-sm",children:(0,r.jsxs)("p",{children:["\xa9 ",new Date().getFullYear()," Guestify"]})})})]})}},5739:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return h}});var r=s(5893),a=s(7294),i=s(1163),n=s(5675),l=s.n(n);s(1664);var c=s(430),o=s(3013),d=s(5240),x=s(2592),m=s(5482);function h(){let[e,t]=(0,a.useState)(""),[s,n]=(0,a.useState)(""),[c,h]=(0,a.useState)(""),[f,u]=(0,a.useState)(!0),[p,g]=(0,a.useState)(null),[b,j]=(0,a.useState)("idle"),[y,N]=(0,a.useState)(""),[w,v]=(0,a.useState)(!0),_=(0,a.useRef)(null),F=(0,i.useRouter)(),{propertyId:k}=F.query,{user:P,profile:R}=(0,m.a)();(0,a.useEffect)(()=>{P&&R&&F.isReady&&(async()=>{try{console.log("PrintQR - Checking Stripe account"),console.log("Profile:",R);let{data:e,error:s}=await d.OQ.from("profiles").select("stripe_account_id").eq("id",P.id).single();if(s)throw s;if(!e.stripe_account_id){console.log("No Stripe account found, redirecting to connect-stripe"),v(!1),localStorage.setItem("property_id_for_qr",k),F.push("/host/connect-stripe");return}v(!1);let{data:r,error:a}=await d.OQ.from("apartments").select("name").eq("id",k).single();if(a)throw a;t(r.name);let i="".concat(window.location.origin,"/guest/menu/").concat(k);h(i);let l=await x.toDataURL(i,{width:300,margin:1,color:{dark:"#5e2bff",light:"#ffffff"}});n(l),u(!1)}catch(e){console.error("Error:",e),g(e.message),u(!1)}})()},[k,P,R,F]);let S=async()=>{try{j("preparing");let e=await fetch("/api/printqr-pdf?propertyId=".concat(k),{method:"GET",headers:{Accept:"application/pdf"}});if(!e.ok)throw Error("Failed to generate PDF");let t=await e.blob(),s=URL.createObjectURL(t);window.open(s,"_blank"),j("ready"),N(s)}catch(e){console.error("Error creating PDF:",e),j("error"),g(e.message||"Failed to generate PDF")}};return w?(0,r.jsxs)("div",{className:"flex justify-center items-center py-12",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-purple-500"}),(0,r.jsx)("p",{className:"ml-3",children:"Checking account status..."})]}):(0,r.jsxs)("div",{children:[(0,r.jsx)(o.Z,{propertyId:k,activeTab:"printqr",propertyName:e}),f?(0,r.jsx)("div",{className:"flex justify-center items-center py-12",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-purple-500"})}):p?(0,r.jsx)("div",{className:"bg-red-100 text-red-700 p-4 rounded-lg mb-6",children:p}):(0,r.jsxs)("div",{className:"max-w-md mx-auto text-center bg-white p-6 rounded-lg shadow-md",children:[(0,r.jsx)("h3",{className:"text-xl font-semibold mb-6",children:"Menu QR Code"}),(0,r.jsx)("p",{className:"mb-6 text-gray-600",children:"Place this QR code in your rental property so guests can easily access your menu."}),(0,r.jsx)("div",{className:"mb-6 border p-4 rounded-lg bg-gray-50 mx-auto",style:{maxWidth:"280px"},ref:_,children:s&&(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-[#5e2bff] font-bold text-lg mb-2",children:"Guestify Menu"}),(0,r.jsx)("div",{className:"mb-4 mx-auto",style:{width:"200px",height:"200px",position:"relative"},children:(0,r.jsx)(l(),{src:s,alt:"QR Code",layout:"fill",objectFit:"contain"})}),(0,r.jsx)("div",{className:"text-sm text-gray-500 mt-2",children:e})]})}),(0,r.jsx)("div",{className:"flex flex-col sm:flex-row justify-center gap-4 mb-6",children:(0,r.jsx)("button",{onClick:S,className:"bg-[#fad02f] text-black px-4 py-2 rounded-full hover:opacity-90 transition font-semibold flex items-center justify-center",disabled:"preparing"===b,children:"preparing"===b?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("i",{className:"fas fa-spinner fa-spin mr-2"}),"Generating PDF..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("i",{className:"fas fa-file-pdf mr-2"}),"Save as PDF"]})})}),"ready"===b&&y&&(0,r.jsxs)("div",{className:"mt-4 p-3 bg-green-50 rounded-lg",children:[(0,r.jsx)("p",{className:"text-sm text-green-700 mb-2",children:"PDF generated successfully!"}),(0,r.jsx)("a",{href:y,download:"guestify-qrcode.pdf",className:"text-[#5e2bff] hover:underline text-sm",children:"Click here to download if it didn't open automatically"})]}),"error"===b&&(0,r.jsx)("div",{className:"mt-4 p-3 bg-red-50 rounded-lg",children:(0,r.jsx)("p",{className:"text-sm text-red-700",children:"There was an error generating the PDF. Please try again."})}),(0,r.jsxs)("div",{className:"mt-6",children:[(0,r.jsx)("p",{className:"text-sm text-gray-500 mb-1",children:"Or share this URL with your guests:"}),(0,r.jsxs)("div",{className:"flex items-center justify-center",children:[(0,r.jsx)("input",{type:"text",value:c,readOnly:!0,className:"w-full text-sm text-gray-700 border rounded-l px-3 py-2 bg-gray-50"}),(0,r.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(c),alert("URL copied to clipboard!")},className:"bg-gray-200 px-3 py-2 rounded-r hover:bg-gray-300 transition-colors",title:"Copy to clipboard",children:(0,r.jsx)("i",{className:"fas fa-copy"})})]})]})]})]})}h.getLayout=function(e){return(0,r.jsx)(c.Z,{title:"Print QR Code - Guestify",children:e})}}},function(e){e.O(0,[61,592,888,774,179],function(){return e(e.s=3847)}),_N_E=e.O()}]);