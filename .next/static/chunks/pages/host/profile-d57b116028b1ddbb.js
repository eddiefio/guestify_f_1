(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[202],{5284:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/host/profile",function(){return t(2296)}])},9555:function(e,s,t){"use strict";t.d(s,{Z:function(){return i}});var r=t(5893),a=t(7294),n=t(1163),l=t(5482);function i(e){let{children:s}=e,{user:t,loading:i,authInitialized:o}=(0,l.a)(),d=(0,n.useRouter)(),[c,u]=(0,a.useState)(!0);return((0,a.useEffect)(()=>{let e=setTimeout(()=>{c&&(console.warn("Route verification timed out, forcing completion"),t||d.push("/auth/signin"),u(!1))},5e3);return!i&&o&&(t?u(!1):(console.log("No user found, redirecting to login"),d.push("/auth/signin"))),()=>clearTimeout(e)},[t,i,o,d,c]),i||c)?(0,r.jsx)("div",{className:"flex justify-center items-center min-h-screen",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-purple-500"})}):(0,r.jsx)(r.Fragment,{children:s})}},430:function(e,s,t){"use strict";t.d(s,{Z:function(){return u}});var r=t(5893),a=t(9008),n=t.n(a),l=t(1664),i=t.n(l),o=t(5675),d=t.n(o);t(1163);var c=t(5482);function u(e){let{children:s,title:t="Guestify"}=e,{user:a,signOut:l}=(0,c.a)();return(0,r.jsxs)("div",{className:"flex flex-col min-h-screen bg-gray-50 text-gray-800",children:[(0,r.jsxs)(n(),{children:[(0,r.jsx)("title",{children:t}),(0,r.jsx)("meta",{name:"description",content:"Guestify - Food service for Airbnb hosts"}),(0,r.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,r.jsx)("header",{className:"bg-[#5e2bff] p-4 shadow-md rounded-b-xl",children:(0,r.jsxs)("div",{className:"max-w-6xl mx-auto flex justify-between items-center",children:[(0,r.jsx)("div",{className:"flex items-center",children:a?(0,r.jsx)(i(),{href:"/host/dashboard",children:(0,r.jsx)("span",{className:"cursor-pointer",children:(0,r.jsx)(d(),{src:"/images/guestify_logo.png",alt:"Guestify",width:40,height:40,quality:100,className:"h-10 w-auto object-contain",priority:!0})})}):(0,r.jsx)("span",{children:(0,r.jsx)(d(),{src:"/images/guestify_logo.png",alt:"Guestify",width:40,height:40,quality:100,className:"h-10 w-auto object-contain",priority:!0})})}),(0,r.jsx)("nav",{className:"flex items-center",children:a?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i(),{href:"/host/dashboard",children:(0,r.jsx)("span",{className:"mx-1 sm:mx-2 text-white font-semibold hover:opacity-80 transition-colors text-sm sm:text-base cursor-pointer",children:"Dashboard"})}),(0,r.jsx)("button",{onClick:l,className:"mx-1 sm:mx-2 text-white hover:opacity-80 transition-colors text-sm sm:text-base bg-transparent border-none cursor-pointer",children:"Logout"}),(0,r.jsx)(i(),{href:"/host/profile",children:(0,r.jsx)("span",{className:"ml-2 cursor-pointer flex items-center",children:(0,r.jsx)("div",{className:"h-8 w-8 rounded-full bg-white text-[#5e2bff] flex items-center justify-center",children:(0,r.jsx)("i",{className:"fas fa-smile"})})})})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i(),{href:"/auth/signin",children:(0,r.jsx)("span",{className:"mx-1 sm:mx-2 text-white hover:opacity-80 transition-colors text-sm sm:text-base cursor-pointer",children:"Login"})}),(0,r.jsx)(i(),{href:"/auth/signup",children:(0,r.jsx)("span",{className:"mx-1 sm:mx-2 text-white hover:opacity-80 transition-colors text-sm sm:text-base cursor-pointer",children:"Signup"})})]})})]})}),(0,r.jsx)("main",{className:"max-w-6xl mx-auto my-4 p-2 sm:p-4 rounded-xl flex-grow w-full",children:s}),(0,r.jsx)("footer",{className:"bg-[#5e2bff] p-4 rounded-t-xl",children:(0,r.jsx)("div",{className:"max-w-6xl mx-auto text-center text-white text-sm",children:(0,r.jsxs)("p",{children:["\xa9 ",new Date().getFullYear()," Guestify"]})})})]})}},2296:function(e,s,t){"use strict";t.r(s);var r=t(5893),a=t(7294),n=t(1163),l=t(430),i=t(5482),o=t(9555);function d(){let{user:e,profile:s,updateProfile:t,updatePassword:l}=(0,i.a)(),[o,d]=(0,a.useState)({name:"",phone:""}),[c,u]=(0,a.useState)({old_password:"",new_password:"",confirm_password:""}),[m,x]=(0,a.useState)(!1),[h,p]=(0,a.useState)(!1),[f,b]=(0,a.useState)(null),[w,j]=(0,a.useState)(null),[g,y]=(0,a.useState)(null),[N,v]=(0,a.useState)(null),[_,P]=(0,a.useState)(!0);(0,n.useRouter)(),(0,a.useEffect)(()=>{let t;let r=!0;return t=setTimeout(()=>{r&&_&&(console.warn("Profile loading timed out, showing default form"),P(!1))},5e3),null!==e&&void 0!==s&&r&&(s?(console.log("Profile data loaded:",s),d({name:s.name||"",phone:s.phone||""}),P(!1)):e&&(console.log("No profile found, using default values"),d({name:e.email?e.email.split("@")[0]:"",phone:""}),P(!1))),()=>{r=!1,clearTimeout(t)}},[s,e]);let k=e=>{let{name:s,value:t}=e.target;d({...o,[s]:t})},C=e=>{let{name:s,value:t}=e.target;u({...c,[s]:t})},S=async e=>{e.preventDefault(),x(!0),y(null),b(null);try{let{error:e}=await t(o);if(e)throw e;b("Profile updated successfully.")}catch(e){console.error("Error updating profile:",e),y(e.message||"Failed to update profile")}finally{x(!1)}},E=async e=>{if(e.preventDefault(),p(!0),v(null),j(null),c.new_password!==c.confirm_password){v("New passwords do not match"),p(!1);return}try{let{error:e}=await l(c.new_password);if(e)throw e;j("Password updated successfully."),u({old_password:"",new_password:"",confirm_password:""})}catch(e){console.error("Error updating password:",e),v(e.message||"Failed to update password")}finally{p(!1)}};return _?(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)("i",{className:"fas fa-spinner fa-spin text-2xl text-gray-500"}),(0,r.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:"Loading your profile..."})]}):(0,r.jsxs)("div",{className:"max-w-3xl mx-auto bg-white p-6 rounded-md shadow mt-10",children:[f&&(0,r.jsx)("div",{className:"mb-6 p-3 bg-green-100 text-green-800 rounded",children:f}),g&&(0,r.jsx)("div",{className:"mb-6 p-3 bg-red-100 text-red-800 rounded",children:g}),(0,r.jsx)("h2",{className:"text-2xl font-bold mb-6",children:"User Profile"}),(0,r.jsxs)("div",{className:"mb-10",children:[(0,r.jsx)("h3",{className:"text-xl font-semibold mb-2",children:"Personal Information"}),(0,r.jsxs)("form",{onSubmit:S,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),(0,r.jsx)("input",{type:"email",value:(null==e?void 0:e.email)||"",className:"w-full border rounded px-3 py-2 bg-gray-100",readOnly:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Country"}),(0,r.jsx)("input",{type:"text",value:(null==s?void 0:s.country)||"Not specified",className:"w-full border rounded px-3 py-2 bg-gray-100",readOnly:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),(0,r.jsx)("input",{type:"text",name:"name",value:o.name,onChange:k,className:"w-full border rounded px-3 py-2",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Phone Number"}),(0,r.jsx)("input",{type:"text",name:"phone",value:o.phone,onChange:k,className:"w-full border rounded px-3 py-2"})]}),(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsx)("button",{type:"submit",className:"px-4 py-2 bg-[#fad02f] text-black rounded hover:opacity-90 transition font-semibold",disabled:m,children:m?"Saving...":"Save"})})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-xl font-semibold mb-2",children:"Change Password"}),w&&(0,r.jsx)("div",{className:"mb-4 p-3 bg-green-100 text-green-800 rounded",children:w}),N&&(0,r.jsx)("div",{className:"mb-4 p-3 bg-red-100 text-red-800 rounded",children:N}),(0,r.jsxs)("form",{onSubmit:E,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Current Password"}),(0,r.jsx)("input",{type:"password",name:"old_password",value:c.old_password,onChange:C,className:"w-full border rounded px-3 py-2",placeholder:"Current Password",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"New Password"}),(0,r.jsx)("input",{type:"password",name:"new_password",value:c.new_password,onChange:C,className:"w-full border rounded px-3 py-2",placeholder:"New Password",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Confirm New Password"}),(0,r.jsx)("input",{type:"password",name:"confirm_password",value:c.confirm_password,onChange:C,className:"w-full border rounded px-3 py-2",placeholder:"Confirm New Password",required:!0})]}),(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsx)("button",{type:"submit",className:"px-4 py-2 bg-[#fad02f] text-black rounded hover:opacity-90 transition font-semibold",disabled:h,children:h?"Updating...":"Change Password"})})]})]})]})}d.getLayout=function(e){return(0,r.jsx)(l.Z,{title:"Profile - Guestify",children:(0,r.jsx)(o.Z,{children:e})})},s.default=d}},function(e){e.O(0,[61,888,774,179],function(){return e(e.s=5284)}),_N_E=e.O()}]);