(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[291],{7159:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/host/add-property",function(){return t(5037)}])},7068:function(e,a,t){"use strict";t.d(a,{Z:function(){return l}});var n=t(5893),s=t(7294),r=t(1664),i=t.n(r),o=t(1163);function l(e){let{cancelHref:a,cancelText:t="Cancel",submitText:r="Save",loading:l=!1,loadingText:c="Saving...",danger:d=!1,onCancel:u,customCancelClass:m="",customSubmitClass:x=""}=e,[h,p]=(0,s.useState)(!1),[b,f]=(0,s.useState)(0),g=(0,o.useRouter)();(0,s.useEffect)(()=>{let e;return l?e=setInterval(()=>{f(e=>{let a=e+1;return a>=10&&!h&&p(!0),a})},1e3):(f(0),p(!1)),()=>{e&&clearInterval(e)}},[l,h]);let y="\n    px-4 py-2 bg-gray-300 text-gray-800 rounded hover:bg-gray-400 \n    transition cursor-pointer ".concat(m,"\n  ");return(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center pt-4",children:[a?(0,n.jsx)(i(),{href:a,children:(0,n.jsx)("span",{className:y,children:t})}):(0,n.jsx)("button",{type:"button",onClick:u,className:y,children:t}),(0,n.jsx)("button",{type:"submit",disabled:l,className:d?"px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600 \n       transition cursor-pointer ".concat(x):"px-4 py-2 bg-[#fad02f] text-black rounded hover:opacity-90 \n       transition font-semibold ".concat(x),children:l?(0,n.jsxs)("span",{className:"flex items-center",children:[(0,n.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-current",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),c," (",b,"s)"]}):r})]}),h?(0,n.jsxs)("div",{className:"text-xs text-red-500 mt-2",children:[(0,n.jsx)("p",{children:"Richiesta bloccata. Puoi:"}),(0,n.jsxs)("div",{className:"flex space-x-4 mt-1",children:[(0,n.jsx)("button",{type:"button",onClick:()=>{a?g.push(a):u?u():g.back()},className:"text-blue-500 underline",children:"Annulla"}),(0,n.jsx)("button",{type:"button",onClick:()=>{window.location.reload()},className:"text-blue-500 underline",children:"Riprova"})]})]}):null]})}},9555:function(e,a,t){"use strict";t.d(a,{Z:function(){return o}});var n=t(5893),s=t(7294),r=t(1163),i=t(5482);function o(e){let{children:a}=e,{user:t,loading:o,authInitialized:l}=(0,i.a)(),c=(0,r.useRouter)(),[d,u]=(0,s.useState)(!0);return((0,s.useEffect)(()=>{let e=setTimeout(()=>{d&&(console.warn("Route verification timed out, forcing completion"),t||c.push("/auth/signin"),u(!1))},5e3);return!o&&l&&(t?u(!1):(console.log("No user found, redirecting to login"),c.push("/auth/signin"))),()=>clearTimeout(e)},[t,o,l,c,d]),o||d)?(0,n.jsx)("div",{className:"flex justify-center items-center min-h-screen",children:(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-purple-500"})}):(0,n.jsx)(n.Fragment,{children:a})}},502:function(e,a,t){"use strict";t.d(a,{O:function(){return r}});var n=t(5893);t(7294);let s=["Afghanistan","Albania","Algeria","Andorra","Angola","Argentina","Armenia","Australia","Austria","Azerbaijan","Bahamas","Bahrain","Bangladesh","Belarus","Belgium","Belize","Benin","Bhutan","Bolivia","Bosnia and Herzegovina","Botswana","Brazil","Brunei","Bulgaria","Burkina Faso","Burundi","Cambodia","Cameroon","Canada","Cape Verde","Central African Republic","Chad","Chile","China","Colombia","Comoros","Costa Rica","Croatia","Cuba","Cyprus","Czech Republic","Democratic Republic of the Congo","Denmark","Djibouti","Dominica","Dominican Republic","Ecuador","Egypt","El Salvador","Equatorial Guinea","Eritrea","Estonia","Eswatini","Ethiopia","Finland","France","Gabon","Gambia","Georgia","Germany","Ghana","Greece","Guatemala","Guinea","Haiti","Honduras","Hungary","Iceland","India","Indonesia","Iran","Iraq","Ireland","Israel","Italy","Ivory Coast","Jamaica","Japan","Jordan","Kazakhstan","Kenya","Kosovo","Kuwait","Kyrgyzstan","Laos","Latvia","Lebanon","Lesotho","Liberia","Libya","Liechtenstein","Lithuania","Luxembourg","Madagascar","Malawi","Malaysia","Maldives","Mali","Malta","Mauritania","Mauritius","Mexico","Moldova","Monaco","Mongolia","Montenegro","Morocco","Mozambique","Myanmar","Namibia","Nepal","Netherlands","New Zealand","Nicaragua","Niger","Nigeria","North Korea","North Macedonia","Norway","Oman","Pakistan","Panama","Papua New Guinea","Paraguay","Peru","Philippines","Poland","Portugal","Qatar","Republic of the Congo","Romania","Russia","Rwanda","Saudi Arabia","Senegal","Serbia","Sierra Leone","Singapore","Slovakia","Slovenia","Somalia","South Africa","South Korea","South Sudan","Spain","Sri Lanka","Sudan","Suriname","Sweden","Switzerland","Syria","Taiwan","Tajikistan","Tanzania","Thailand","Timor-Leste","Togo","Trinidad and Tobago","Tunisia","Turkey","Turkmenistan","Uganda","Ukraine","United Arab Emirates","United Kingdom","United States","Uruguay","Uzbekistan","Vatican City","Venezuela","Vietnam","Yemen","Zambia","Zimbabwe"];function r(e){let{value:a,onChange:t,id:r,name:i,className:o,required:l}=e;return(0,n.jsxs)("select",{id:r,name:i||"country",value:a,onChange:e=>{t({target:{name:i||"country",value:e.target.value}})},className:o,required:l,children:[(0,n.jsx)("option",{value:"",children:"Select country..."}),s.map(e=>(0,n.jsx)("option",{value:e,children:e},e))]})}},430:function(e,a,t){"use strict";t.d(a,{Z:function(){return u}});var n=t(5893),s=t(9008),r=t.n(s),i=t(1664),o=t.n(i),l=t(5675),c=t.n(l);t(1163);var d=t(5482);function u(e){let{children:a,title:t="Guestify"}=e,{user:s,signOut:i}=(0,d.a)();return(0,n.jsxs)("div",{className:"flex flex-col min-h-screen bg-gray-50 text-gray-800",children:[(0,n.jsxs)(r(),{children:[(0,n.jsx)("title",{children:t}),(0,n.jsx)("meta",{name:"description",content:"Guestify - Food service for Airbnb hosts"}),(0,n.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,n.jsx)("header",{className:"bg-[#5e2bff] p-4 shadow-md rounded-b-xl",children:(0,n.jsxs)("div",{className:"max-w-6xl mx-auto flex justify-between items-center",children:[(0,n.jsx)("div",{className:"flex items-center",children:s?(0,n.jsx)(o(),{href:"/host/dashboard",children:(0,n.jsx)("span",{className:"cursor-pointer",children:(0,n.jsx)(c(),{src:"/images/guestify_logo.png",alt:"Guestify",width:40,height:40,quality:100,className:"h-10 w-auto object-contain",priority:!0})})}):(0,n.jsx)("span",{children:(0,n.jsx)(c(),{src:"/images/guestify_logo.png",alt:"Guestify",width:40,height:40,quality:100,className:"h-10 w-auto object-contain",priority:!0})})}),(0,n.jsx)("nav",{className:"flex items-center",children:s?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o(),{href:"/host/dashboard",children:(0,n.jsx)("span",{className:"mx-1 sm:mx-2 text-white font-semibold hover:opacity-80 transition-colors text-sm sm:text-base cursor-pointer",children:"Dashboard"})}),(0,n.jsx)("button",{onClick:i,className:"mx-1 sm:mx-2 text-white hover:opacity-80 transition-colors text-sm sm:text-base bg-transparent border-none cursor-pointer",children:"Logout"}),(0,n.jsx)(o(),{href:"/host/profile",children:(0,n.jsx)("span",{className:"ml-2 cursor-pointer flex items-center",children:(0,n.jsx)("div",{className:"h-8 w-8 rounded-full bg-white text-[#5e2bff] flex items-center justify-center",children:(0,n.jsx)("i",{className:"fas fa-smile"})})})})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o(),{href:"/auth/signin",children:(0,n.jsx)("span",{className:"mx-1 sm:mx-2 text-white hover:opacity-80 transition-colors text-sm sm:text-base cursor-pointer",children:"Login"})}),(0,n.jsx)(o(),{href:"/auth/signup",children:(0,n.jsx)("span",{className:"mx-1 sm:mx-2 text-white hover:opacity-80 transition-colors text-sm sm:text-base cursor-pointer",children:"Signup"})})]})})]})}),(0,n.jsx)("main",{className:"max-w-6xl mx-auto my-4 p-2 sm:p-4 rounded-xl flex-grow w-full",children:a}),(0,n.jsx)("footer",{className:"bg-[#5e2bff] p-4 rounded-t-xl",children:(0,n.jsx)("div",{className:"max-w-6xl mx-auto text-center text-white text-sm",children:(0,n.jsxs)("p",{children:["\xa9 ",new Date().getFullYear()," Guestify"]})})})]})}},5037:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return m}});var n=t(5893),s=t(7294),r=t(1163),i=t(430),o=t(5482),l=t(5240),c=t(502),d=t(9555),u=t(7068);function m(){let[e,a]=(0,s.useState)({rental_name:"",address:"",city:"",state:"",zip:"",country:""}),[t,i]=(0,s.useState)(!1),[d,m]=(0,s.useState)(null),[x,h]=(0,s.useState)(!1),p=(0,r.useRouter)(),{user:b}=(0,o.a)(),f=e=>{let{name:t,value:n}=e.target;console.log("Field ".concat(t," changed to ").concat(n)),a(e=>({...e,[t]:n}))},g=async a=>{if(a.preventDefault(),!b){m("You must be logged in to add a property");return}if(!e.country){m("Please select a country");return}i(!0),m(null);try{console.log("Submitting form data:",e);let a=new Promise((e,a)=>{setTimeout(()=>a(Error("Request timed out")),1e4)}),t=(0,l.q4)(async()=>{let{data:a,error:t}=await l.OQ.from("apartments").insert([{host_id:b.id,name:e.rental_name,address:e.address,city:e.city,state:e.state,zip:e.zip,country:e.country}]).select().single();if(t)throw t;return a}),n=await Promise.race([t,a]);console.log("Property created successfully:",n),h(!0),setTimeout(()=>{p.push("/host/dashboard")},1e3)}catch(e){console.error("Error creating property:",e),m(e.message||"Failed to create property. Please try again."),i(!1)}};return x?(0,n.jsx)("div",{className:"max-w-md mx-auto bg-white p-6 rounded-md shadow mt-10",children:(0,n.jsx)("div",{className:"bg-green-100 text-green-700 p-3 rounded mb-4",children:"Property added successfully! Redirecting to dashboard..."})}):(0,n.jsxs)("div",{className:"max-w-md mx-auto bg-white p-6 rounded-md shadow mt-10",children:[(0,n.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Add Property"}),d&&(0,n.jsx)("div",{className:"bg-red-100 text-red-700 p-3 rounded mb-4",children:d}),(0,n.jsxs)("form",{onSubmit:g,className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"rental_name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Rental Name"}),(0,n.jsx)("input",{type:"text",id:"rental_name",name:"rental_name",value:e.rental_name,onChange:f,className:"w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Good Place",required:!0,disabled:t})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"country",className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Country"}),(0,n.jsx)(c.O,{id:"country",name:"country",value:e.country,onChange:f,className:"w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:t}),e.country&&(0,n.jsxs)("p",{className:"text-xs text-green-600 mt-1",children:["Selected: ",e.country]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"address",className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),(0,n.jsx)("input",{type:"text",id:"address",name:"address",value:e.address,onChange:f,className:"w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter full address",required:!0,disabled:t})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"city",className:"block text-sm font-medium text-gray-700 mb-1",children:"City"}),(0,n.jsx)("input",{type:"text",id:"city",name:"city",value:e.city,onChange:f,className:"w-full border rounded px-3 py-2",placeholder:"City",disabled:t})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"state",className:"block text-sm font-medium text-gray-700 mb-1",children:"State"}),(0,n.jsx)("input",{type:"text",id:"state",name:"state",value:e.state,onChange:f,className:"w-full border rounded px-3 py-2",placeholder:"State",disabled:t})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"zip",className:"block text-sm font-medium text-gray-700 mb-1",children:"ZIP Code"}),(0,n.jsx)("input",{type:"text",id:"zip",name:"zip",value:e.zip,onChange:f,className:"w-full border rounded px-3 py-2",placeholder:"90210",disabled:t})]}),(0,n.jsx)(u.Z,{cancelHref:"/host/dashboard",submitText:"Save",loading:t,loadingText:"Saving..."}),t&&(0,n.jsx)("div",{className:"text-center mt-2",children:(0,n.jsx)("button",{type:"button",onClick:()=>{i(!1),p.push("/host/dashboard")},className:"text-sm text-gray-500 underline",children:"Cancel and go back"})})]})]})}m.getLayout=function(e){return(0,n.jsx)(i.Z,{title:"Add Property - Guestify",children:(0,n.jsx)(d.Z,{children:e})})}}},function(e){e.O(0,[61,888,774,179],function(){return e(e.s=7159)}),_N_E=e.O()}]);